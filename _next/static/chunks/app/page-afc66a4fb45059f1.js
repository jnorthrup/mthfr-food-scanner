(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{294:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>ts});var s=t(5155),n=t(2115),i=t(4492),r=t(6497),l=t(5959),o=t(9863);let d={location:{consentType:"location",granted:!1,version:1},photo:{consentType:"photo",granted:!1,version:1},review:{consentType:"review",granted:!1,version:1},data_contribution:{consentType:"data_contribution",granted:!1,version:1}},c={mthfr:!0,eu_standards:!0,genetic_mutations:!0,allergens:!0,additives:!0,allergy_soy:!1,allergy_wheat:!1,allergy_milk:!1,allergy_egg:!1,allergy_peanut:!1,allergy_treenuts:!1,allergy_fish:!1,allergy_shellfish:!1,allergy_sesame:!1,mutation_g6pd:!1},m=(0,l.v)()((0,o.Zr)((e,a)=>({currentProduct:null,scanHistory:[],favorites:[],consents:d,restrictionSettings:c,isLoading:!1,error:null,hasCompletedOnboarding:!1,activeTab:"home",setCurrentProduct:a=>e({currentProduct:a}),addToHistory:t=>{let s=a().scanHistory,n=s.findIndex(e=>e.upc===t.upc);if(n>=0){let a=[...s];a[n]={...t,lastScannedAt:new Date},e({scanHistory:a})}else e({scanHistory:[{...t,lastScannedAt:new Date},...s].slice(0,100)})},toggleFavorite:t=>{let s=a().scanHistory,n=a().favorites,i=s.find(e=>e.id===t);i&&(n.some(e=>e.id===t)?e({favorites:n.filter(e=>e.id!==t)}):e({favorites:[...n,{...i,isFavorite:!0}]}))},setConsent:(t,s)=>{let n=a().consents;e({consents:{...n,[t]:{...n[t],granted:s,grantedAt:s?new Date:void 0,withdrawnAt:s?void 0:new Date}}})},toggleRestriction:t=>{let s=a().restrictionSettings;e({restrictionSettings:{...s,[t]:!s[t]}})},setLoading:a=>e({isLoading:a}),setError:a=>e({error:a}),completeOnboarding:()=>e({hasCompletedOnboarding:!0}),setActiveTab:a=>e({activeTab:a}),clearHistory:()=>e({scanHistory:[]}),toggleAllRestrictions:(t,s)=>{let n={...a().restrictionSettings};t.forEach(e=>{n[e]=s}),e({restrictionSettings:n})}}),{name:"mthfr-scanner-storage",partialize:e=>({scanHistory:e.scanHistory,favorites:e.favorites,consents:e.consents,restrictionSettings:e.restrictionSettings,hasCompletedOnboarding:e.hasCompletedOnboarding})}));var u=t(3278);class f extends u.Ay{constructor(){super("MTHFRFoodScanner"),this.version(1).stores({products:"++id, upc, name, brand, sourceProvenance, createdAt, isFavorite, lastScannedAt",canonicalIngredients:"++id, canonicalName, *synonyms, safetyStatus, category",maskingTerms:"++id, term, riskLevel",classificationRules:"++id, ingredientPattern, safetyStatus, version",userConsents:"++id, consentType, granted",scanHistory:"++id, productId, scannedAt, upc"}),this.version(2).stores({products:"++id, upc, name, brand, sourceProvenance, createdAt, isFavorite, lastScannedAt",canonicalIngredients:"++id, canonicalName, *synonyms, safetyStatus, category",maskingTerms:"++id, term, riskLevel",classificationRules:"++id, ingredientPattern, safetyStatus, profile, version",userConsents:"++id, consentType, granted",scanHistory:"++id, productId, scannedAt, upc"}),this.version(3).stores({products:"++id, upc, name, brand, sourceProvenance, createdAt, isFavorite, lastScannedAt",canonicalIngredients:"++id, canonicalName, *synonyms, safetyStatus, category",maskingTerms:"++id, term, riskLevel",classificationRules:"++id, ingredientPattern, safetyStatus, profile, version",userConsents:"++id, consentType, granted",scanHistory:"++id, productId, scannedAt, upc"})}}let h=new f;async function x(){0===await h.canonicalIngredients.count()&&await g(),0===await h.maskingTerms.count()&&await p(),0===await h.classificationRules.count()&&await y()}async function g(){await h.canonicalIngredients.bulkAdd([{canonicalName:"folic acid",synonyms:["folacin","vitamin b9","pteroylglutamic acid","synthetic folate"],safetyStatus:"unsafe",safetyReason:"Synthetic folic acid can interfere with methylation in individuals with MTHFR variants. It may block folate receptors and inhibit natural folate metabolism.",evidence:"Research indicates that unmetabolized folic acid may compete with natural folates for cellular uptake.",category:"vitamins"},{canonicalName:"methylfolate",synonyms:["5-mthf","l-methylfolate","5-methyltetrahydrofolate","metafolin","quatrefolic","active folate"],safetyStatus:"safe",safetyReason:"Methylfolate is the bioactive form of folate that bypasses the MTHFR enzyme, making it suitable for individuals with MTHFR variants.",evidence:"Methylfolate does not require conversion by the MTHFR enzyme.",category:"vitamins"},{canonicalName:"cyanocobalamin",synonyms:["vitamin b12 (cyanocobalamin)","synthetic b12"],safetyStatus:"unsafe",safetyReason:"Cyanocobalamin is a synthetic form of B12 that requires conversion and contains a cyanide molecule. May not be efficiently processed by those with MTHFR variants.",evidence:"The body must convert cyanocobalamin to methylcobalamin or adenosylcobalamin for use.",category:"vitamins"},{canonicalName:"methylcobalamin",synonyms:["methyl b12","active b12","coenzyme b12"],safetyStatus:"safe",safetyReason:"Methylcobalamin is the bioactive methylated form of vitamin B12 that supports methylation directly.",evidence:"Already in active form, no conversion needed.",category:"vitamins"},{canonicalName:"hydroxocobalamin",synonyms:["hydroxycobalamin","b12a"],safetyStatus:"safe",safetyReason:"Hydroxocobalamin is a natural form of B12 that the body can convert to active forms.",evidence:"Natural form found in food, easily converted.",category:"vitamins"},{canonicalName:"adenosylcobalamin",synonyms:["dibencozide","cobamamide","coenzyme b12"],safetyStatus:"safe",safetyReason:"Adenosylcobalamin is a bioactive form of B12 used directly in cellular energy production.",evidence:"Active coenzyme form of B12.",category:"vitamins"},{canonicalName:"pyridoxine hydrochloride",synonyms:["vitamin b6 (pyridoxine)","pyridoxine hcl","synthetic b6"],safetyStatus:"unknown",safetyReason:"While generally usable, some individuals with MTHFR variants may benefit from pyridoxal-5-phosphate instead.",category:"vitamins"},{canonicalName:"pyridoxal-5-phosphate",synonyms:["p5p","plp","active b6","pyridoxal phosphate"],safetyStatus:"safe",safetyReason:"P5P is the active coenzyme form of vitamin B6 that supports methylation reactions.",category:"vitamins"},{canonicalName:"riboflavin",synonyms:["vitamin b2","riboflavin-5-phosphate"],safetyStatus:"safe",safetyReason:"Riboflavin is essential for MTHFR enzyme function and supports methylation.",evidence:"B2 is a cofactor for the MTHFR enzyme.",category:"vitamins"},{canonicalName:"monosodium glutamate",synonyms:["msg","glutamate","e621","sodium glutamate"],safetyStatus:"unsafe",safetyReason:"MSG is an excitotoxin that may affect neurological function and can be problematic for some with MTHFR variants.",category:"additives"},{canonicalName:"aspartame",synonyms:["e951","nutrasweet","equal","canderel"],safetyStatus:"unsafe",safetyReason:"Aspartame breaks down into phenylalanine and can affect neurotransmitter balance. May be problematic for methylation.",category:"sweeteners"},{canonicalName:"high fructose corn syrup",synonyms:["hfcs","glucose-fructose syrup","isoglucose","corn sugar"],safetyStatus:"unsafe",safetyReason:"HFCS may deplete nutrients needed for methylation and contribute to inflammation.",category:"sweeteners"},{canonicalName:"sodium nitrite",synonyms:["nitrite","e250","curing salt"],safetyStatus:"unsafe",safetyReason:"Nitrites can form nitrosamines and may interfere with oxygen transport and methylation processes.",category:"preservatives"},{canonicalName:"sodium nitrate",synonyms:["nitrate","e251","chile saltpeter"],safetyStatus:"unsafe",safetyReason:"Nitrates convert to nitrites in the body and may affect methylation and overall health.",category:"preservatives"},{canonicalName:"bht",synonyms:["butylated hydroxytoluene","e321"],safetyStatus:"unsafe",safetyReason:"BHT is a synthetic antioxidant that may affect hormones and cellular function.",category:"preservatives"},{canonicalName:"bha",synonyms:["butylated hydroxyanisole","e320"],safetyStatus:"unsafe",safetyReason:"BHA is a synthetic preservative with potential endocrine-disrupting effects.",category:"preservatives"},{canonicalName:"tbhq",synonyms:["tertiary butylhydroquinone","e319"],safetyStatus:"unsafe",safetyReason:"TBHQ is a synthetic preservative derived from petroleum that may affect immune function.",category:"preservatives"},{canonicalName:"carrageenan",synonyms:["e407","irish moss extract"],safetyStatus:"unknown",safetyReason:"Carrageenan may cause gut inflammation in some individuals, which can affect nutrient absorption.",category:"additives"},{canonicalName:"potassium bromate",synonyms:["bromate","e924"],safetyStatus:"unsafe",safetyReason:"Potassium bromate is a possible carcinogen and can affect thyroid function.",category:"additives"},{canonicalName:"sodium benzoate",synonyms:["benzoate","e211"],safetyStatus:"unsafe",safetyReason:"Sodium benzoate can form benzene when combined with vitamin C and may deplete glutathione.",category:"preservatives"},{canonicalName:"propyl gallate",synonyms:["e310","propyl 3,4,5-trihydroxybenzoate"],safetyStatus:"unsafe",safetyReason:"Propyl gallate is a synthetic antioxidant that may have estrogenic effects.",category:"preservatives"},{canonicalName:"water",synonyms:["purified water","filtered water","spring water","mineral water","aqua"],safetyStatus:"safe",safetyReason:"Water is essential and does not affect methylation.",category:"base"},{canonicalName:"salt",synonyms:["sodium chloride","sea salt","table salt","kosher salt","himalayan salt"],safetyStatus:"safe",safetyReason:"Natural salt in moderate amounts does not affect methylation.",category:"base"},{canonicalName:"sugar",synonyms:["cane sugar","beet sugar","sucrose","granulated sugar"],safetyStatus:"safe",safetyReason:"Natural sugar in moderate amounts is generally safe for methylation.",category:"sweeteners"},{canonicalName:"olive oil",synonyms:["extra virgin olive oil","evoo","virgin olive oil"],safetyStatus:"safe",safetyReason:"Olive oil is a healthy fat that does not interfere with methylation.",category:"fats"},{canonicalName:"coconut oil",synonyms:["virgin coconut oil","refined coconut oil"],safetyStatus:"safe",safetyReason:"Coconut oil is a healthy fat that supports cellular function.",category:"fats"}])}async function p(){await h.maskingTerms.bulkAdd([{term:"natural flavors",riskLevel:"high",reason:"Natural flavors can contain hundreds of undisclosed ingredients including MSG, preservatives, and synthetic additives. The term is loosely regulated and may hide problematic components.",verificationGuidance:"Contact the manufacturer to request a complete breakdown of natural flavor components. Ask specifically about MSG, glutamates, and any synthetic processing aids."},{term:"artificial flavors",riskLevel:"high",reason:"Artificial flavors are synthetic compounds that may contain excitotoxins, preservatives, or other additives that could affect methylation.",verificationGuidance:"Request the specific artificial flavor compounds from the manufacturer. Consider avoiding products with artificial flavors when possible."},{term:"spices",riskLevel:"medium",reason:'The term "spices" can hide MSG, anti-caking agents, or preservatives. While often benign, specifics are not disclosed.',verificationGuidance:"Ask the manufacturer for a complete spice breakdown. Look for products that list specific spices."},{term:"proprietary blend",riskLevel:"high",reason:"Proprietary blends hide exact ingredient amounts and may contain undisclosed fillers, flow agents, or synthetic additives.",verificationGuidance:"Contact manufacturer for complete ingredient disclosure. Be cautious of proprietary blends in supplements."},{term:"other ingredients",riskLevel:"high",reason:"This catch-all term may include unlisted additives, processing aids, or ingredients below labeling thresholds.",verificationGuidance:"Request complete ingredient list from manufacturer. Consider choosing products with full transparency."},{term:"processing aids",riskLevel:"medium",reason:"Processing aids may include enzymes, solvents, or chemicals used during manufacturing that remain in trace amounts.",verificationGuidance:"Ask manufacturer about specific processing aids used. Look for organic or minimally processed alternatives."},{term:"flavor enhancers",riskLevel:"high",reason:"Flavor enhancers often include MSG or similar glutamate compounds that may affect those with MTHFR variants.",verificationGuidance:"Request specific flavor enhancer identification. Look for E-numbers (E620-E625 are glutamates)."},{term:"yeast extract",riskLevel:"medium",reason:"Yeast extract naturally contains glutamates (similar to MSG) and may affect sensitive individuals.",verificationGuidance:"Contains free glutamic acid. May be problematic for MSG-sensitive individuals."},{term:"hydrolyzed protein",riskLevel:"high",reason:"Hydrolyzed proteins contain free glutamic acid (MSG) created during processing.",verificationGuidance:"Treat similarly to MSG. Includes hydrolyzed vegetable protein, hydrolyzed soy protein, etc."},{term:"autolyzed yeast",riskLevel:"medium",reason:"Autolyzed yeast contains naturally occurring MSG-like compounds.",verificationGuidance:"Contains free glutamates. Consider sensitivity if avoiding MSG."},{term:"natural colors",riskLevel:"low",reason:"While generally safer than artificial colors, natural colors may come from sources that cause reactions in some individuals.",verificationGuidance:"Ask for specific color sources. Common sources include carmine (insects), annatto (seeds), turmeric."},{term:"enzymes",riskLevel:"low",reason:"Enzymes are generally safe but may be derived from sources that concern some individuals (fungal, bacterial, or animal).",verificationGuidance:"Ask about enzyme sources if you have specific dietary restrictions."},{term:"modified food starch",riskLevel:"medium",reason:"Modified starches may be chemically treated and could contain residual processing chemicals.",verificationGuidance:"Ask about the type of modification and source (corn, wheat, tapioca)."},{term:"natural sweeteners",riskLevel:"low",reason:"Term may include various sweeteners with different safety profiles. Could contain stevia, monk fruit, or sugar alcohols.",verificationGuidance:"Ask for specific sweetener identification to verify individual safety."}])}async function y(){let e=[{ingredientPattern:"folic acid",safetyStatus:"unsafe",reason:"Synthetic folic acid requires MTHFR enzyme conversion and may accumulate unmetabolized.",evidence:"MTHFR C677T and A1298C variants reduce conversion efficiency by 30-70%.",profile:"mthfr",version:1,createdAt:new Date},{ingredientPattern:"cyanocobalamin",safetyStatus:"unsafe",reason:"Synthetic B12 form requires conversion and contains cyanide molecule.",evidence:"Methylcobalamin or adenosylcobalamin are preferred for MTHFR variants.",profile:"mthfr",version:1,createdAt:new Date},{ingredientPattern:"enriched|fortified",safetyStatus:"unsafe",reason:"Enriched and fortified foods typically contain synthetic folic acid.",evidence:"US fortification mandate uses synthetic folic acid in grain products.",profile:"mthfr",version:1,createdAt:new Date},{ingredientPattern:"methylfolate|5-mthf|l-methylfolate",safetyStatus:"safe",reason:"Active form of folate that bypasses MTHFR enzyme.",evidence:"Direct cellular uptake without conversion requirement.",profile:"mthfr",version:1,createdAt:new Date},{ingredientPattern:"methylcobalamin|adenosylcobalamin|hydroxocobalamin",safetyStatus:"safe",reason:"Active or easily converted forms of vitamin B12.",evidence:"Preferred B12 forms for MTHFR-affected individuals.",profile:"mthfr",version:1,createdAt:new Date},{ingredientPattern:"msg|monosodium glutamate|glutamate",safetyStatus:"unsafe",reason:"Excitotoxin that may affect neurological function.",evidence:"May deplete glutathione and affect detoxification pathways.",profile:"mthfr",version:1,createdAt:new Date},{ingredientPattern:"titanium dioxide|e171",safetyStatus:"unsafe",reason:"Banned in the EU due to concerns about genotoxicity and its ability to accumulate in the body.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"potassium bromate|e924",safetyStatus:"unsafe",reason:"Banned in the EU, Canada, and other countries. Classified as a possible carcinogen.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"azodicarbonamide|e927a",safetyStatus:"unsafe",reason:"Banned in the EU and Australia. May break down into semicarbazide, which is a carcinogen.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"brominated vegetable oil|bvo",safetyStatus:"unsafe",reason:"Banned in the EU. Contains bromine, which can accumulate in the body and lead to neurological issues.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"yellow 5|tartrazine|e102",safetyStatus:"unknown",reason:"Requires a warning label in the EU. May cause hyperactivity in children and allergic reactions.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"yellow 6|sunset yellow|e110",safetyStatus:"unknown",reason:"Requires a warning label in the EU. May cause hyperactivity in children.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"red 40|allura red|e129",safetyStatus:"unknown",reason:"Requires a warning label in the EU. May cause hyperactivity in children.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"propylparaben|e216",safetyStatus:"unsafe",reason:"Banned in the EU as a food additive due to endocrine-disrupting potential.",profile:"eu_standards",version:1,createdAt:new Date},{ingredientPattern:"fava bean|broad bean|vicia faba",safetyStatus:"unsafe",reason:"Can cause hemolytic anemia in individuals with G6PD deficiency (Favism).",profile:"mutation_g6pd",version:1,createdAt:new Date},{ingredientPattern:"soy|soya|lecithin \\(soy\\)",safetyStatus:"unknown",reason:"Common allergen. Often genetically modified.",profile:"allergy_soy",version:1,createdAt:new Date},{ingredientPattern:"wheat|gluten",safetyStatus:"unknown",reason:"Common allergen and source of gluten.",profile:"allergy_wheat",version:1,createdAt:new Date},{ingredientPattern:"milk|lactose|whey|casein",safetyStatus:"unknown",reason:"Common dairy allergen.",profile:"allergy_milk",version:1,createdAt:new Date},{ingredientPattern:"egg",safetyStatus:"unknown",reason:"Common allergen.",profile:"allergy_egg",version:1,createdAt:new Date},{ingredientPattern:"peanut",safetyStatus:"unknown",reason:"Common high-risk allergen.",profile:"allergy_peanut",version:1,createdAt:new Date},{ingredientPattern:"almond|cashew|walnut|hazelnut|pistachio|macadamia|pecan|brazil nut",safetyStatus:"unknown",reason:"Common tree nut allergen.",profile:"allergy_treenuts",version:1,createdAt:new Date},{ingredientPattern:"fish",safetyStatus:"unknown",reason:"Common allergen.",profile:"allergy_fish",version:1,createdAt:new Date},{ingredientPattern:"shrimp|prawn|crab|lobster|mussel|clam|oyster|scallop|shellfish",safetyStatus:"unknown",reason:"Common shellfish allergen.",profile:"allergy_shellfish",version:1,createdAt:new Date},{ingredientPattern:"sesame",safetyStatus:"unknown",reason:"Common allergen.",profile:"allergy_sesame",version:1,createdAt:new Date},{ingredientPattern:"aspartame|e951",safetyStatus:"unsafe",reason:"Artificial sweetener that may affect neurotransmitter balance.",profile:"additives",version:1,createdAt:new Date},{ingredientPattern:"high fructose corn syrup|hfcs",safetyStatus:"unsafe",reason:"Highly refined sweetener linked to metabolic issues.",profile:"additives",version:1,createdAt:new Date},{ingredientPattern:"sodium nitrite|sodium nitrate|e250|e251",safetyStatus:"unsafe",reason:"Preservatives that can form nitrosamines.",profile:"additives",version:1,createdAt:new Date}];await h.classificationRules.bulkAdd(e)}async function b(){await h.products.clear(),await h.scanHistory.clear()}async function v(){return JSON.stringify({products:await h.products.toArray(),scanHistory:await h.scanHistory.toArray(),consents:await h.userConsents.toArray(),exportedAt:new Date().toISOString()},null,2)}let j=[{name:"Open Food Facts",priority:1,fetchProduct:async function(e){try{let a=await fetch("".concat("https://world.openfoodfacts.org/api/v2","/product/").concat(e,".json"),{headers:{"User-Agent":"MTHFRFoodScanner/1.0 (contact@example.com)"}});if(!a.ok)return null;let t=await a.json();if(1!==t.status||!t.product)return null;let s=t.product;return{upc:e,name:s.product_name||s.product_name_en||"Unknown Product",brand:s.brands||void 0,ingredients:s.ingredients_text||s.ingredients_text_en||void 0,imageUrl:s.image_front_url||s.image_url||void 0,source:"open_food_facts"}}catch(e){return console.error("Open Food Facts API error:",e),null}}},{name:"UPC Item DB",priority:2,fetchProduct:async function(e){try{var a;let t=await fetch("https://api.upcitemdb.com/prod/trial/lookup?upc=".concat(e),{headers:{Accept:"application/json"}});if(!t.ok)return null;let s=await t.json();if(!s.items||0===s.items.length)return null;let n=s.items[0];return{upc:e,name:n.title||"Unknown Product",brand:n.brand||void 0,ingredients:n.description||void 0,imageUrl:(null==(a=n.images)?void 0:a[0])||void 0,source:"upc_item_db"}}catch(e){return console.error("UPC Item DB API error:",e),null}}}];async function N(e){let a=function(e){let a=e.replace(/[^0-9]/g,"");return 12===a.length?a:13===a.length&&a.startsWith("0")?a.substring(1):13===a.length?a:a.length<12?a.padStart(12,"0"):a}(e),t=[];for(let e of j.sort((e,a)=>e.priority-a.priority)){t.push(e.name);try{let s=await e.fetchProduct(a);if(s)return{success:!0,product:s,source:"api",searchedAPIs:t}}catch(a){console.error("Error fetching from ".concat(e.name,":"),a)}}return{success:!1,product:null,source:"api",error:"Product not found in any database",searchedAPIs:t}}var w=t(3736);let k=null,A=new Map;async function C(){let e=await h.canonicalIngredients.toArray();for(let a of(A.clear(),e))for(let e of(A.set(a.canonicalName.toLowerCase(),a),a.synonyms))A.set(e.toLowerCase(),a);let a=e.flatMap(e=>[{...e,searchName:e.canonicalName},...e.synonyms.map(a=>({...e,searchName:a}))]);k=new w.A(a,{keys:["searchName"],threshold:.3,includeScore:!0,ignoreLocation:!0})}async function S(e){let a=e.toLowerCase().trim().replace(/[^\w\s\-']/g," ").replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").replace(/\d+(\.\d+)?\s*(mg|g|ml|mcg|iu|%)/gi,"").trim(),t=A.get(a);if(t)return{originalText:e,normalizedName:a,canonicalName:t.canonicalName,confidence:1};if(k){let t=k.search(a);if(t.length>0&&void 0!==t[0].score){let s=1-t[0].score;if(s>=.7)return{originalText:e,normalizedName:a,canonicalName:t[0].item.canonicalName,confidence:s}}}return{originalText:e,normalizedName:a,canonicalName:a,confidence:.5}}async function P(e){let a=function(e){if(!e||""===e.trim())return[];let a=e,t=(a=(a=(a=(a=(a=a.replace(/contains\s*(?:less\s*than\s*)?[\d.]+%\s*(?:of\s*)?:?/gi,",")).replace(/contains\s*(?:one\s*or\s*more\s*of\s*)?:?/gi,",")).replace(/may\s*contain:?/gi,",")).replace(/ingredients:?/gi,"")).replace(/\s*\([^()]*\)/g,e=>{let a=e.slice(1,-1);return a.includes(",")?" [".concat(a,"]"):e})).split(/,(?![^[]*\])/).map(e=>e.trim()).filter(Boolean),s=[];for(let e of t)if(e.includes("[")){let a=e.match(/^([^[]+)\s*\[([^\]]+)\]/);if(a){let e=a[1].trim(),t=a[2].split(",").map(e=>e.trim());for(let a of(s.push(e),t))s.push("  ".concat(a))}else s.push(e.replace(/[\[\]]/g,""))}else if(e.includes("(")){let a=e.match(/^([^(]+)\s*\(([^)]+)\)/);a?s.push(a[1].trim()):s.push(e)}else s.push(e);return s.map(e=>e.trim()).filter(e=>e.length>0)}(e),t=[];for(let e of a){let a=e.startsWith("  "),s=e.trim();if(s){let e=await S(s);if(a){let a=t[t.length-1];a&&!a.subIngredients&&(a.subIngredients=[]),a&&a.subIngredients.push(e)}else t.push(e)}}return t}let R=[],z=[],M=new Map;async function _(){R=await h.classificationRules.toArray(),z=await h.maskingTerms.toArray();let e=await h.canonicalIngredients.toArray();for(let a of(M.clear(),e))for(let e of(M.set(a.canonicalName.toLowerCase(),a),a.synonyms))M.set(e.toLowerCase(),a)}function T(e){let a=function e(a){let t=[];for(let s of a)t.push(s),s.subIngredients&&s.subIngredients.length>0&&t.push(...e(s.subIngredients));return t}(e),t=a.filter(e=>"safe"===e.safetyStatus).length,s=a.filter(e=>"unsafe"===e.safetyStatus).length,n=a.filter(e=>"unknown"===e.safetyStatus).length,i=a.length,r=a.filter(e=>"unsafe"===e.safetyStatus),l=a.filter(e=>e.isMasking);return{overallStatus:s>0?"unsafe":n>.5*i||l.some(e=>"high"===e.maskingRiskLevel)||n>0?"unknown":"safe",safeCount:t,unsafeCount:s,unknownCount:n,safePercentage:i>0?Math.round(t/i*100):0,unsafePercentage:i>0?Math.round(s/i*100):0,unknownPercentage:i>0?Math.round(n/i*100):0,unsafeIngredients:r,maskingIngredients:l,totalIngredients:i}}async function F(e){var a;let t=e.ingredients.map(e=>e.name.toLowerCase()).join(", "),s=["corn","soy","beet sugar","canola","cottonseed","papaya","zucchini"].some(e=>t.includes(e)),n={monsanto:{summary:"Heavy litigation regarding glyphosate.",details:["Roundup cancer lawsuits","Bayer/Monsanto settlement"]},nestle:{summary:"Various ethical and health-related lawsuits.",details:["Water rights litigation","Infant formula controversy"]},kellogg:{summary:"Occasional misleading advertising lawsuits.",details:["Sugar content claims"]}},i=(null==(a=e.brand)?void 0:a.toLowerCase())||"",r=Object.keys(n).find(e=>i.includes(e)),l=r?{status:"found",...n[r]}:{status:"none",summary:"No major recent lawsuits found for this brand in our database.",details:[]},o=["artificial","synthetic","processed"].some(a=>t.includes(a)||e.name.toLowerCase().includes(a)),d=o?-.3:.5;return{gmoStatus:s?"medium":"low",gmoLikelihood:s?.7:.1,gmoReasoning:s?"Contains ingredients frequently derived from GMO crops in the US (e.g., corn/soy).":"No common GMO-linked ingredients detected in standard list.",lawsuits:l,sentiment:{score:d,label:d>0?"positive":d<0?"negative":"neutral",anchors:o?["processed","artificial"]:["natural","reliable"]}}}let L=!1;async function D(){L||(await x(),await C(),await _(),L=!0)}async function U(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];await D();let t=await h.products.where("upc").equals(e).first();if(t){let a=T(t.ingredients);return await h.scanHistory.add({productId:t.id,scannedAt:new Date,upc:e}),{success:!0,product:{...t,lastScannedAt:new Date},safety:a,source:t.sourceProvenance,risk:await F(t)}}let s=await N(e);if(!s.success||!s.product)return a?H(e,"Demo Product","Water, Enriched Wheat Flour (Wheat Flour, Niacin, Reduced Iron, Thiamine Mononitrate, Riboflavin, Folic Acid), Sugar, Natural Flavors, Salt, Yeast Extract, Citric Acid","Demo Brand",void 0,"manual"):{success:!1,product:null,safety:null,error:s.error||"Product not found",source:"api",notFound:!0};let n=s.product;return H(n.upc,n.name,n.ingredients||"",n.brand,n.imageUrl,"api")}async function H(e,a,t,s,n){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"manual";await D();try{let r=await P(t),l=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";return e.map(e=>(function e(a){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",n=a.canonicalName.toLowerCase(),i=a.originalText.toLowerCase(),r="unknown",l=M.get(n);if(l)r=l.safetyStatus,t=l.safetyReason;else{let{restrictionSettings:e}=m.getState();for(let a of R){if(!e[a.profile])continue;let s=RegExp(a.ingredientPattern,"i");if(s.test(i)||s.test(n)){r=a.safetyStatus,t=a.reason;break}}}let o=function(e){let a=e.toLowerCase();for(let e of z)if(a.includes(e.term.toLowerCase()))return{isMasking:!0,reason:e.reason,riskLevel:e.riskLevel,verificationGuidance:e.verificationGuidance};for(let a of[{pattern:/and\/or/i,reason:"Ingredient composition is variable and unspecified"},{pattern:/one or more of/i,reason:"Multiple possible ingredients, exact composition unknown"},{pattern:/may contain/i,reason:"Potential cross-contamination or variable formulation"},{pattern:/less than \d+%/i,reason:"Minor ingredients may not be fully disclosed"}])if(a.pattern.test(e))return{isMasking:!0,reason:a.reason,riskLevel:"medium"};return{isMasking:!1}}(i),d={originalText:a.originalText,canonicalName:a.canonicalName,normalizedName:a.normalizedName,confidence:a.confidence,safetyStatus:r,safetyReason:t,isMasking:o.isMasking,maskingReason:o.reason,maskingRiskLevel:o.riskLevel,sourceProvenance:s};if(a.subIngredients&&a.subIngredients.length>0&&(d.subIngredients=a.subIngredients.map(a=>e(a,s)),d.subIngredients.some(e=>"unsafe"===e.safetyStatus)&&"unsafe"!==r)){d.safetyStatus="unsafe";let e=d.subIngredients.filter(e=>"unsafe"===e.safetyStatus);d.safetyReason="Contains unsafe sub-ingredients: ".concat(e.map(e=>e.canonicalName).join(", "))}return d})(e,a))}(r,i),o=T(l),d={upc:e,name:a,brand:s,imageUrl:n,ingredients:l,sourceProvenance:i,createdAt:new Date,updatedAt:new Date,lastScannedAt:new Date},c=await h.products.add(d),u={...d,id:c};return void 0!==c&&await h.scanHistory.add({productId:c,scannedAt:new Date,upc:e}),{success:!0,product:u,safety:o,source:i,risk:await F(u)}}catch(e){return console.error("Error processing product:",e),{success:!1,product:null,safety:null,error:e instanceof Error?e.message:"Failed to process product",source:i}}}var I=t(5993),E=t(111),G=t(4485),O=t(5870),B=t(2821),q=t(5889);function W(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,q.QP)((0,B.$)(a))}let Y=[{id:"home",label:"Home",icon:I.A},{id:"scan",label:"Scan",icon:E.A},{id:"history",label:"History",icon:G.A},{id:"settings",label:"Settings",icon:O.A}];function V(){let{activeTab:e,setActiveTab:a}=m();return(0,s.jsx)("nav",{"data-design-id":"bottom-nav",className:"fixed bottom-0 left-0 right-0 z-50 glass bg-card/90 border-t border-border",children:(0,s.jsx)("div",{className:"flex items-center justify-around h-16 max-w-lg mx-auto mobile-safe-area",children:Y.map(t=>{let n=e===t.id,r=t.icon;return(0,s.jsxs)("button",{"data-design-id":"nav-item-".concat(t.id),onClick:()=>a(t.id),className:W("relative flex flex-col items-center justify-center w-16 h-full transition-all duration-200","focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/50 rounded-lg",n?"text-primary":"text-muted-foreground hover:text-foreground"),children:[n&&(0,s.jsx)(i.P.div,{layoutId:"nav-indicator",className:"absolute -top-0.5 w-8 h-1 rounded-full safe-bg",transition:{type:"spring",stiffness:500,damping:35}}),(0,s.jsx)(i.P.div,{animate:{scale:n?1.1:1},transition:{type:"spring",stiffness:400,damping:20},children:(0,s.jsx)(r,{className:"w-5 h-5",strokeWidth:n?2.5:2})}),(0,s.jsx)("span",{className:W("text-[10px] mt-0.5 font-medium",n?"font-semibold":""),children:t.label})]},t.id)})})})}var J=t(5740),Z=t(7910),$=t(2056),K=t(6989),Q=t(3036),X=t(9068),ee=t(7744),ea=t(9788),et=t(5589),es=t(368),en=t(7937),ei=t(2467),er=t(3101);let el=(0,er.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),eo=n.forwardRef((e,a)=>{let{className:t,variant:n,size:i,asChild:r=!1,...l}=e,o=r?ei.DX:"button";return(0,s.jsx)(o,{className:W(el({variant:n,size:i,className:t})),ref:a,...l})});eo.displayName="Button";var ed=t(7621);let ec=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(ed.bL,{className:W("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:a,children:(0,s.jsx)(ed.zi,{className:W("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});ec.displayName=ed.bL.displayName;let em=[{id:"welcome",title:"Welcome to MTHFR Scanner",description:"Your personal guide to finding foods that support healthy methylation. Scan products and get instant safety analysis.",icon:J.A,iconBg:"bg-gradient-to-br from-emerald-400 to-teal-500",iconColor:"text-white"},{id:"scan",title:"Scan or Enter Products",description:"Use your camera to scan barcodes or manually enter product information. We'll look up ingredients from trusted databases.",icon:E.A,iconBg:"bg-gradient-to-br from-blue-400 to-indigo-500",iconColor:"text-white"},{id:"analyze",title:"MTHFR Safety Analysis",description:"Each ingredient is evaluated against MTHFR-safe criteria. We identify synthetic vitamins, additives, and other problematic components.",icon:Z.A,iconBg:"bg-gradient-to-br from-purple-400 to-pink-500",iconColor:"text-white"},{id:"masking",title:"Detect Hidden Ingredients",description:'We flag vague terms like "natural flavors" that may mask hazardous ingredients, helping you make informed decisions.',icon:$.A,iconBg:"bg-gradient-to-br from-amber-400 to-orange-500",iconColor:"text-white"},{id:"personalize",title:"Personalize Your Scanner",description:"Select the health standards and restrictions that matter most to you. You can change these anytime in settings.",icon:K.A,iconBg:"bg-gradient-to-br from-rose-400 to-red-500",iconColor:"text-white"}];function eu(){let[e,a]=(0,n.useState)(0),{completeOnboarding:t,restrictionSettings:l,toggleRestriction:o}=m(),d=em[e],c=e===em.length-1,u=d.icon;return(0,s.jsxs)("div",{"data-design-id":"onboarding-flow",className:"fixed inset-0 bg-background z-50 flex flex-col",children:[(0,s.jsx)("div",{"data-design-id":"onboarding-header",className:"p-4 flex justify-end",children:(0,s.jsx)(eo,{"data-design-id":"onboarding-skip",variant:"ghost",size:"sm",onClick:()=>{t()},className:"text-muted-foreground",children:"Skip"})}),(0,s.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center px-8",children:(0,s.jsx)(r.N,{mode:"wait",children:(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},className:"flex flex-col items-center text-center max-w-sm",children:[(0,s.jsx)(i.P.div,{"data-design-id":"onboarding-icon-".concat(d.id),initial:{scale:.8,rotate:-10},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:300,damping:20},className:"w-28 h-28 rounded-3xl ".concat(d.iconBg," flex items-center justify-center mb-8 shadow-xl"),children:(0,s.jsx)(u,{className:"w-14 h-14 ".concat(d.iconColor)})}),(0,s.jsx)("h1",{"data-design-id":"onboarding-title-".concat(d.id),className:"text-2xl font-bold mb-4",children:d.title}),(0,s.jsx)("p",{"data-design-id":"onboarding-desc-".concat(d.id),className:"text-muted-foreground leading-relaxed",children:d.description}),"personalize"===d.id&&(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"w-full mt-8 space-y-3 text-left",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-muted/50 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(Q.A,{className:"w-5 h-5 text-emerald-600"}),(0,s.jsx)("span",{className:"font-medium text-sm",children:"MTHFR Support"})]}),(0,s.jsx)(ec,{checked:l.mthfr,onCheckedChange:()=>o("mthfr")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-muted/50 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(X.A,{className:"w-5 h-5 text-blue-600"}),(0,s.jsx)("span",{className:"font-medium text-sm",children:"EU Standards"})]}),(0,s.jsx)(ec,{checked:l.eu_standards,onCheckedChange:()=>o("eu_standards")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-muted/50 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(ee.A,{className:"w-5 h-5 text-purple-600"}),(0,s.jsx)("span",{className:"font-medium text-sm",children:"Genetic Mutations"})]}),(0,s.jsx)(ec,{checked:l.genetic_mutations,onCheckedChange:()=>o("genetic_mutations")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-muted/50 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(ea.A,{className:"w-5 h-5 text-orange-600"}),(0,s.jsx)("span",{className:"font-medium text-sm",children:"Allergens"})]}),(0,s.jsx)(ec,{checked:l.allergens,onCheckedChange:()=>o("allergens")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-muted/50 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(et.A,{className:"w-5 h-5 text-amber-600"}),(0,s.jsx)("span",{className:"font-medium text-sm",children:"Additives"})]}),(0,s.jsx)(ec,{checked:l.additives,onCheckedChange:()=>o("additives")})]})]})]},d.id)})}),(0,s.jsx)("div",{"data-design-id":"onboarding-progress",className:"flex justify-center gap-2 mb-8",children:em.map((a,t)=>(0,s.jsx)(i.P.div,{"data-design-id":"onboarding-dot-".concat(t),className:"h-2 rounded-full transition-all duration-300 ".concat(t===e?"w-8 bg-primary":t<e?"w-2 bg-primary/50":"w-2 bg-muted")},t))}),(0,s.jsxs)("div",{"data-design-id":"onboarding-actions",className:"p-6 flex gap-3",children:[e>0&&(0,s.jsxs)(eo,{"data-design-id":"onboarding-prev",variant:"outline",size:"lg",onClick:()=>{e>0&&a(e=>e-1)},className:"flex-1",children:[(0,s.jsx)(es.A,{className:"w-4 h-4 mr-1"}),"Back"]}),(0,s.jsx)(eo,{"data-design-id":"onboarding-next",size:"lg",onClick:()=>{c?t():a(e=>e+1)},className:"".concat(0===e?"w-full":"flex-1"),children:c?(0,s.jsxs)(s.Fragment,{children:["Get Started",(0,s.jsx)(J.A,{className:"w-4 h-4 ml-2"})]}):(0,s.jsxs)(s.Fragment,{children:["Next",(0,s.jsx)(en.A,{className:"w-4 h-4 ml-1"})]})})]})]})}var ef=t(6651),eh=t(6191),ex=t(1524),eg=t(3457),ep=t(6983);let ey=n.forwardRef((e,a)=>{let{className:t,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:W("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...i})});ey.displayName="Input";let eb=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("rounded-xl border bg-card text-card-foreground shadow",t),...n})});eb.displayName="Card";let ev=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("flex flex-col space-y-1.5 p-6",t),...n})});ev.displayName="CardHeader";let ej=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("font-semibold leading-none tracking-tight",t),...n})});ej.displayName="CardTitle";let eN=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("text-sm text-muted-foreground",t),...n})});eN.displayName="CardDescription";let ew=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("p-6 pt-0",t),...n})});ew.displayName="CardContent",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter";var ek=t(5239),eA=t(5710),eC=t(5664),eS=t(5880),eP=t(508),eR=t(7181),ez=t(7801),eM=t(2817),e_=t(1362),eT=t(908),eF=t(8874);let eL={safe:{icon:Z.A,label:"MTHFR Safe",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-50 dark:bg-emerald-950/50",borderColor:"border-emerald-200 dark:border-emerald-800"},unsafe:{icon:ez.A,label:"Contains Unsafe Ingredients",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-950/50",borderColor:"border-red-200 dark:border-red-800"},unknown:{icon:eM.A,label:"Requires Review",color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-50 dark:bg-amber-950/50",borderColor:"border-amber-200 dark:border-amber-800"}};function eD(e){let{summary:a,compact:t=!1}=e,n=eL[a.overallStatus],r=n.icon;return t?(0,s.jsxs)("div",{"data-design-id":"safety-summary-compact",className:W("flex items-center gap-2 px-3 py-1.5 rounded-full border",n.bgColor,n.borderColor),children:[(0,s.jsx)(r,{className:W("w-4 h-4",n.color)}),(0,s.jsx)("span",{className:W("text-sm font-medium",n.color),children:"safe"===a.overallStatus?"Safe":"unsafe"===a.overallStatus?"".concat(a.unsafeCount," Unsafe"):"Review Needed"})]}):(0,s.jsxs)(i.P.div,{"data-design-id":"safety-summary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:W("rounded-2xl border-2 p-5 space-y-4",n.bgColor,n.borderColor),children:[(0,s.jsxs)("div",{"data-design-id":"safety-summary-header",className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:W("w-14 h-14 rounded-xl flex items-center justify-center","safe"===a.overallStatus?"bg-emerald-500":"unsafe"===a.overallStatus?"bg-red-500":"bg-amber-500"),children:(0,s.jsx)(r,{className:"w-7 h-7 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{"data-design-id":"safety-summary-title",className:W("text-lg font-bold",n.color),children:n.label}),(0,s.jsxs)("p",{"data-design-id":"safety-summary-subtitle",className:"text-sm text-muted-foreground",children:[a.totalIngredients," ingredients analyzed"]})]})]}),(0,s.jsxs)("div",{"data-design-id":"safety-summary-bars",className:"space-y-2",children:[(0,s.jsxs)("div",{className:"h-3 rounded-full bg-muted overflow-hidden flex",children:[(0,s.jsx)(i.P.div,{"data-design-id":"safety-bar-safe",initial:{width:0},animate:{width:"".concat(a.safePercentage,"%")},transition:{duration:.5,delay:.1},className:"h-full bg-emerald-500"}),(0,s.jsx)(i.P.div,{"data-design-id":"safety-bar-unknown",initial:{width:0},animate:{width:"".concat(a.unknownPercentage,"%")},transition:{duration:.5,delay:.2},className:"h-full bg-amber-500"}),(0,s.jsx)(i.P.div,{"data-design-id":"safety-bar-unsafe",initial:{width:0},animate:{width:"".concat(a.unsafePercentage,"%")},transition:{duration:.5,delay:.3},className:"h-full bg-red-500"})]}),(0,s.jsxs)("div",{"data-design-id":"safety-summary-legend",className:"flex justify-between text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(e_.A,{className:"w-3.5 h-3.5 text-emerald-500"}),(0,s.jsxs)("span",{children:[a.safeCount," Safe (",a.safePercentage,"%)"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(eT.A,{className:"w-3.5 h-3.5 text-amber-500"}),(0,s.jsxs)("span",{children:[a.unknownCount," Unknown (",a.unknownPercentage,"%)"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(eF.A,{className:"w-3.5 h-3.5 text-red-500"}),(0,s.jsxs)("span",{children:[a.unsafeCount," Unsafe (",a.unsafePercentage,"%)"]})]})]})]}),a.unsafeIngredients.length>0&&(0,s.jsxs)("div",{"data-design-id":"unsafe-ingredients-list",className:"space-y-2",children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold text-red-600 dark:text-red-400 flex items-center gap-2",children:[(0,s.jsx)(eF.A,{className:"w-4 h-4"}),"Unsafe Ingredients"]}),(0,s.jsxs)("div",{className:"space-y-1.5",children:[a.unsafeIngredients.slice(0,5).map((e,a)=>(0,s.jsxs)("div",{"data-design-id":"unsafe-ingredient-".concat(a),className:"flex items-start gap-2 text-sm bg-red-100 dark:bg-red-900/30 rounded-lg px-3 py-2",children:[(0,s.jsx)($.A,{className:"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-red-700 dark:text-red-300",children:e.canonicalName}),e.safetyReason&&(0,s.jsx)("p",{className:"text-xs text-red-600/80 dark:text-red-400/80 mt-0.5",children:e.safetyReason})]})]},a)),a.unsafeIngredients.length>5&&(0,s.jsxs)("p",{className:"text-xs text-red-500 pl-6",children:["+",a.unsafeIngredients.length-5," more unsafe ingredients"]})]})]}),a.maskingIngredients.length>0&&(0,s.jsxs)("div",{"data-design-id":"masking-ingredients-list",className:"space-y-2",children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold text-violet-600 dark:text-violet-400 flex items-center gap-2",children:[(0,s.jsx)($.A,{className:"w-4 h-4"}),"Masking Ingredients"]}),(0,s.jsx)("div",{className:"space-y-1.5",children:a.maskingIngredients.slice(0,3).map((e,a)=>(0,s.jsxs)("div",{"data-design-id":"masking-ingredient-".concat(a),className:"flex items-start gap-2 text-sm bg-violet-100 dark:bg-violet-900/30 rounded-lg px-3 py-2",children:[(0,s.jsx)($.A,{className:"w-4 h-4 text-violet-500 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-violet-700 dark:text-violet-300",children:e.canonicalName}),e.maskingReason&&(0,s.jsx)("p",{className:"text-xs text-violet-600/80 dark:text-violet-400/80 mt-0.5",children:e.maskingReason})]})]},a))})]})]})}let eU=(0,er.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eH(e){let{className:a,variant:t,...n}=e;return(0,s.jsx)("div",{className:W(eU({variant:t}),a),...n})}let eI={api:eA.A,ocr:eC.A,review:eS.A,manual:eP.A,community:eP.A},eE={api:"Product Database",ocr:"Photo OCR",review:"Review Data",manual:"Manual Entry",community:"Community"};function eG(e){let{product:a,onSelect:t,onToggleFavorite:n,compact:r=!1,showDetails:l=!1}=e,o=T(a.ingredients),d=eI[a.sourceProvenance];return r?(0,s.jsxs)(i.P.button,{"data-design-id":"product-card-compact-".concat(a.upc),onClick:t,whileTap:{scale:.98},className:"w-full flex items-center gap-4 p-4 bg-card rounded-xl border border-border hover:border-primary/30 hover:shadow-sm transition-all text-left",children:[a.imageUrl?(0,s.jsx)("div",{"data-design-id":"product-image-".concat(a.upc),className:"w-14 h-14 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:(0,s.jsx)(ek.default,{src:a.imageUrl,alt:a.name,width:56,height:56,className:"w-full h-full object-cover"})}):(0,s.jsx)("div",{"data-design-id":"product-placeholder-".concat(a.upc),className:"w-14 h-14 rounded-lg bg-muted flex items-center justify-center flex-shrink-0",children:(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCE6"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{"data-design-id":"product-name-".concat(a.upc),className:"font-semibold text-sm truncate",children:a.name}),a.brand&&(0,s.jsx)("p",{"data-design-id":"product-brand-".concat(a.upc),className:"text-xs text-muted-foreground truncate",children:a.brand}),(0,s.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,s.jsx)(eD,{summary:o,compact:!0})})]}),(0,s.jsx)(en.A,{className:"w-5 h-5 text-muted-foreground flex-shrink-0"})]}):(0,s.jsxs)(i.P.div,{"data-design-id":"product-card-".concat(a.upc),initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-2xl border border-border overflow-hidden",children:[(0,s.jsxs)("div",{"data-design-id":"product-header-".concat(a.upc),className:"relative",children:[a.imageUrl?(0,s.jsx)("div",{className:"aspect-video bg-muted",children:(0,s.jsx)(ek.default,{src:a.imageUrl,alt:a.name,fill:!0,className:"object-contain"})}):(0,s.jsx)("div",{className:"aspect-video bg-gradient-to-br from-muted to-muted/50 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-6xl",children:"\uD83D\uDCE6"})}),n&&(0,s.jsx)(eo,{"data-design-id":"favorite-btn-".concat(a.upc),variant:"ghost",size:"icon",onClick:e=>{e.stopPropagation(),n()},className:"absolute top-3 right-3 glass bg-white/80 dark:bg-black/50 hover:bg-white dark:hover:bg-black/70",children:(0,s.jsx)(eg.A,{className:W("w-5 h-5 transition-colors",a.isFavorite?"fill-red-500 text-red-500":"text-muted-foreground")})}),(0,s.jsx)(eo,{"data-design-id":"share-btn-".concat(a.upc),variant:"ghost",size:"icon",onClick:e=>{e.stopPropagation(),navigator.share?navigator.share({title:a.name,text:"Check out ".concat(a.name," (UPC: ").concat(a.upc,") on MTHFR Food Scanner"),url:window.location.href}).catch(e=>console.error("Share failed:",e)):navigator.clipboard.writeText("".concat(a.name," (UPC: ").concat(a.upc,")")).then(()=>{alert("Copied to clipboard!")})},className:"absolute top-3 right-14 glass bg-white/80 dark:bg-black/50 hover:bg-white dark:hover:bg-black/70",children:(0,s.jsx)(eR.A,{className:"w-5 h-5 text-muted-foreground"})}),(0,s.jsx)("div",{"data-design-id":"source-badge-".concat(a.upc),className:"absolute bottom-3 left-3",children:(0,s.jsxs)(eH,{variant:"secondary",className:"glass bg-white/90 dark:bg-black/70",children:[(0,s.jsx)(d,{className:"w-3 h-3 mr-1"}),eE[a.sourceProvenance]]})})]}),(0,s.jsxs)("div",{"data-design-id":"product-content-".concat(a.upc),className:"p-5 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{"data-design-id":"product-title-".concat(a.upc),className:"text-xl font-bold",children:a.name}),a.brand&&(0,s.jsx)("p",{"data-design-id":"product-brand-full-".concat(a.upc),className:"text-muted-foreground",children:a.brand}),(0,s.jsxs)("p",{"data-design-id":"product-upc-".concat(a.upc),className:"text-xs text-muted-foreground mt-1 font-mono",children:["UPC: ",a.upc]})]}),(0,s.jsx)(eD,{summary:o}),a.lastScannedAt&&(0,s.jsxs)("div",{"data-design-id":"last-scanned-".concat(a.upc),className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(ep.A,{className:"w-3.5 h-3.5"}),"Last scanned: ",new Date(a.lastScannedAt).toLocaleDateString()]}),l&&t&&(0,s.jsxs)(eo,{"data-design-id":"view-details-btn-".concat(a.upc),onClick:t,className:"w-full",children:["View Full Details",(0,s.jsx)(en.A,{className:"w-4 h-4 ml-1"})]})]})]})}var eO=t(2912);let eB=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,s.jsxs)(eO.bL,{ref:a,className:W("relative overflow-hidden",t),...i,children:[(0,s.jsx)(eO.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,s.jsx)(eq,{}),(0,s.jsx)(eO.OK,{})]})});eB.displayName=eO.bL.displayName;let eq=n.forwardRef((e,a)=>{let{className:t,orientation:n="vertical",...i}=e;return(0,s.jsx)(eO.VM,{ref:a,orientation:n,className:W("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...i,children:(0,s.jsx)(eO.lr,{className:"relative flex-1 rounded-full bg-border"})})});function eW(){let{scanHistory:e,favorites:a,setActiveTab:t,setCurrentProduct:r}=m(),[l,o]=(0,n.useState)(""),[d,c]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=new Date().getHours();e<12?c("Good morning"):e<18?c("Good afternoon"):c("Good evening")},[]);let u=e.slice(0,5),f=l?e.filter(e=>{var a;return e.name.toLowerCase().includes(l.toLowerCase())||(null==(a=e.brand)?void 0:a.toLowerCase().includes(l.toLowerCase()))||e.upc.includes(l)}):[];return(0,s.jsx)(eB,{className:"h-full",children:(0,s.jsxs)("div",{"data-design-id":"home-screen",className:"pb-24 px-5 pt-4 space-y-6",children:[(0,s.jsxs)(i.P.div,{"data-design-id":"home-header",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"space-y-1",children:[(0,s.jsx)("h1",{"data-design-id":"home-greeting",className:"text-2xl font-bold",children:d}),(0,s.jsx)("p",{"data-design-id":"home-subtitle",className:"text-muted-foreground",children:"Ready to scan your next product?"})]}),(0,s.jsxs)(i.P.div,{"data-design-id":"home-search",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"relative",children:[(0,s.jsx)(ef.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(ey,{"data-design-id":"home-search-input",placeholder:"Search scanned products...",value:l,onChange:e=>o(e.target.value),className:"pl-10 h-12 rounded-xl"})]}),l&&f.length>0&&(0,s.jsxs)(i.P.div,{"data-design-id":"search-results",initial:{opacity:0},animate:{opacity:1},className:"space-y-3",children:[(0,s.jsx)("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Search Results"}),(0,s.jsx)("div",{className:"space-y-2",children:f.map(e=>(0,s.jsx)(eG,{product:e,compact:!0,onSelect:()=>{r(e),t("history")}},e.id))})]}),!l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.P.div,{"data-design-id":"quick-actions",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)(eo,{"data-design-id":"action-scan",onClick:()=>t("scan"),className:"h-28 flex-col gap-2 rounded-2xl bg-gradient-to-br from-primary to-emerald-600 hover:from-primary/90 hover:to-emerald-600/90 shadow-lg shadow-primary/20",children:[(0,s.jsx)(E.A,{className:"w-8 h-8"}),(0,s.jsx)("span",{className:"font-semibold",children:"Scan Product"})]}),(0,s.jsxs)(eo,{"data-design-id":"action-manual",variant:"outline",onClick:()=>t("scan"),className:"h-28 flex-col gap-2 rounded-2xl border-2 hover:bg-secondary/50",children:[(0,s.jsx)(eh.A,{className:"w-8 h-8"}),(0,s.jsx)("span",{className:"font-semibold",children:"Add Manually"})]})]}),(0,s.jsxs)(i.P.div,{"data-design-id":"stats-section",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"grid grid-cols-3 gap-3",children:[(0,s.jsx)(eb,{"data-design-id":"stat-scanned",className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/50 dark:to-blue-900/30 border-blue-200 dark:border-blue-800",children:(0,s.jsxs)(ew,{className:"p-4 text-center",children:[(0,s.jsx)(ex.A,{className:"w-5 h-5 mx-auto mb-1 text-blue-600 dark:text-blue-400"}),(0,s.jsx)("p",{"data-design-id":"stat-scanned-value",className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:e.length}),(0,s.jsx)("p",{className:"text-xs text-blue-600/80 dark:text-blue-400/80",children:"Scanned"})]})}),(0,s.jsx)(eb,{"data-design-id":"stat-favorites",className:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-950/50 dark:to-pink-900/30 border-pink-200 dark:border-pink-800",children:(0,s.jsxs)(ew,{className:"p-4 text-center",children:[(0,s.jsx)(eg.A,{className:"w-5 h-5 mx-auto mb-1 text-pink-600 dark:text-pink-400"}),(0,s.jsx)("p",{"data-design-id":"stat-favorites-value",className:"text-2xl font-bold text-pink-700 dark:text-pink-300",children:a.length}),(0,s.jsx)("p",{className:"text-xs text-pink-600/80 dark:text-pink-400/80",children:"Favorites"})]})}),(0,s.jsx)(eb,{"data-design-id":"stat-safe",className:"bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-950/50 dark:to-emerald-900/30 border-emerald-200 dark:border-emerald-800",children:(0,s.jsxs)(ew,{className:"p-4 text-center",children:[(0,s.jsx)(J.A,{className:"w-5 h-5 mx-auto mb-1 text-emerald-600 dark:text-emerald-400"}),(0,s.jsx)("p",{"data-design-id":"stat-safe-value",className:"text-2xl font-bold text-emerald-700 dark:text-emerald-300",children:e.filter(e=>e.ingredients.every(e=>"safe"===e.safetyStatus)).length}),(0,s.jsx)("p",{className:"text-xs text-emerald-600/80 dark:text-emerald-400/80",children:"Safe"})]})})]}),u.length>0&&(0,s.jsxs)(i.P.div,{"data-design-id":"recent-scans",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{"data-design-id":"recent-title",className:"font-semibold flex items-center gap-2",children:[(0,s.jsx)(ep.A,{className:"w-4 h-4"}),"Recent Scans"]}),(0,s.jsxs)(eo,{"data-design-id":"view-all-btn",variant:"ghost",size:"sm",onClick:()=>t("history"),className:"text-primary",children:["View All",(0,s.jsx)(en.A,{className:"w-4 h-4 ml-1"})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:u.map((e,a)=>(0,s.jsx)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+.1*a},children:(0,s.jsx)(eG,{product:e,compact:!0,onSelect:()=>{r(e),t("history")}})},e.id))})]}),0===u.length&&(0,s.jsxs)(i.P.div,{"data-design-id":"empty-state",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-center py-12",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-muted flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(E.A,{className:"w-10 h-10 text-muted-foreground"})}),(0,s.jsx)("h3",{"data-design-id":"empty-title",className:"font-semibold mb-2",children:"No products scanned yet"}),(0,s.jsx)("p",{"data-design-id":"empty-desc",className:"text-sm text-muted-foreground mb-4",children:"Start by scanning a product barcode or adding one manually"}),(0,s.jsxs)(eo,{"data-design-id":"empty-cta",onClick:()=>t("scan"),children:[(0,s.jsx)(E.A,{className:"w-4 h-4 mr-2"}),"Scan Your First Product"]})]})]})]})})}eq.displayName=eO.VM.displayName;var eY=t(2583),eV=t(5299),eJ=t(5626),eZ=t(1716),e$=t(6132),eK=t(1514),eQ=t(5229);function eX(e){let{onScan:a,onClose:t,isActive:i=!0}=e;return(0,n.useEffect)(()=>{if(!i)return;let e=null,t=setTimeout(()=>{let t=[eK.Jl.UPC_A,eK.Jl.UPC_E,eK.Jl.UPC_EAN_EXTENSION,eK.Jl.EAN_13,eK.Jl.EAN_8,eK.Jl.CODE_128,eK.Jl.CODE_39];(e=new eK.TF("qr-reader",{fps:10,qrbox:{width:300,height:150},aspectRatio:16/9,formatsToSupport:t},!1)).render(e=>{a(e)},e=>{})},100);return()=>{clearTimeout(t),e&&e.clear().catch(e=>console.error("Failed to clear scanner",e))}},[i,a]),(0,s.jsxs)("div",{className:"relative w-full h-full flex flex-col bg-black",children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 z-20 p-4 flex justify-between items-center pointer-events-none",children:t&&(0,s.jsx)(eo,{variant:"ghost",size:"icon",onClick:t,className:"glass bg-black/50 text-white hover:bg-black/70 pointer-events-auto",children:(0,s.jsx)(eQ.A,{className:"w-6 h-6"})})}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center w-full relative",children:(0,s.jsx)("div",{id:"qr-reader",className:"w-[100vw] h-[100dvh] object-cover"})})]})}var e0=t(3327),e1=t(6083),e5=t(4033);let e2=e1.bL,e4=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(e1.q7,{ref:a,className:W("border-b",t),...n})});e4.displayName="AccordionItem";let e3=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,s.jsx)(e1.Y9,{className:"flex",children:(0,s.jsxs)(e1.l9,{ref:a,className:W("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...i,children:[n,(0,s.jsx)(e5.A,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})})});e3.displayName=e1.l9.displayName;let e6=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,s.jsx)(e1.UC,{ref:a,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:(0,s.jsx)("div",{className:W("pb-4 pt-0",t),children:n})})});e6.displayName=e1.UC.displayName;var e8=t(1617);let e9=e8.Kq;e8.bL,e8.l9,n.forwardRef((e,a)=>{let{className:t,sideOffset:n=4,...i}=e;return(0,s.jsx)(e8.ZL,{children:(0,s.jsx)(e8.UC,{ref:a,sideOffset:n,className:W("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...i})})}).displayName=e8.UC.displayName;let e7={safe:{icon:e_.A,color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-50 dark:bg-emerald-950/30",label:"Safe"},unsafe:{icon:eF.A,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-950/30",label:"Unsafe"},unknown:{icon:eT.A,color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-50 dark:bg-amber-950/30",label:"Unknown"}},ae={high:{color:"bg-red-500",label:"High Risk"},medium:{color:"bg-amber-500",label:"Medium Risk"},low:{color:"bg-blue-500",label:"Low Risk"}};function aa(e){var a;let{ingredient:t,index:n,showProvenance:r=!1}=e,l=e7[t.safetyStatus],o=l.icon;return t.safetyReason||t.maskingReason||(null==(a=t.subIngredients)?void 0:a.length)?(0,s.jsx)(i.P.div,{"data-design-id":"ingredient-accordion-".concat(n),initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.03*n},children:(0,s.jsx)(e2,{type:"single",collapsible:!0,children:(0,s.jsxs)(e4,{value:"ing-".concat(n),className:"border-0",children:[(0,s.jsxs)(e3,{className:W("p-3 rounded-xl border hover:no-underline",l.bgColor,"border-transparent hover:border-border/50"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(o,{className:W("w-5 h-5 flex-shrink-0",l.color)}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("span",{className:"font-medium",children:t.canonicalName}),t.originalText.toLowerCase()!==t.canonicalName.toLowerCase()&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",t.originalText,")"]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 mr-2",children:t.isMasking&&t.maskingRiskLevel&&(0,s.jsxs)(eH,{variant:"outline",className:W("text-[10px] px-1.5",ae[t.maskingRiskLevel].color,"text-white border-0"),children:[(0,s.jsx)($.A,{className:"w-3 h-3 mr-0.5"}),"Masking"]})})]}),(0,s.jsx)(e6,{className:"px-3 pt-2 pb-3",children:(0,s.jsxs)("div",{className:"space-y-3 pl-8",children:[t.safetyReason&&(0,s.jsxs)("div",{"data-design-id":"safety-reason-".concat(n),className:"flex items-start gap-2 text-sm",children:[(0,s.jsx)(e0.A,{className:"w-4 h-4 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:t.safetyReason})]}),t.isMasking&&t.maskingReason&&(0,s.jsxs)("div",{"data-design-id":"masking-reason-".concat(n),className:"flex items-start gap-2 text-sm bg-violet-50 dark:bg-violet-950/30 rounded-lg p-2",children:[(0,s.jsx)($.A,{className:"w-4 h-4 text-violet-500 mt-0.5 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-violet-700 dark:text-violet-300",children:t.maskingReason})]}),t.subIngredients&&t.subIngredients.length>0&&(0,s.jsxs)("div",{"data-design-id":"sub-ingredients-".concat(n),className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Sub-ingredients:"}),(0,s.jsx)("div",{className:"space-y-1.5 pl-2 border-l-2 border-muted",children:t.subIngredients.map((e,a)=>{let t=e7[e.safetyStatus],i=t.icon;return(0,s.jsxs)("div",{"data-design-id":"sub-ingredient-".concat(n,"-").concat(a),className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(i,{className:W("w-4 h-4",t.color)}),(0,s.jsx)("span",{children:e.canonicalName})]},a)})})]}),(0,s.jsxs)("div",{"data-design-id":"confidence-".concat(n),className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsxs)("span",{children:["Confidence: ",Math.round(100*t.confidence),"%"]}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:""}),(0,s.jsxs)("span",{children:["Source: ",t.sourceProvenance]})]})]})]})})]})})}):(0,s.jsxs)(i.P.div,{"data-design-id":"ingredient-item-".concat(n),initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.03*n},className:W("flex items-center justify-between p-3 rounded-xl border",l.bgColor,"border-transparent"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(o,{className:W("w-5 h-5 flex-shrink-0",l.color)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:t.canonicalName}),t.originalText.toLowerCase()!==t.canonicalName.toLowerCase()&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",t.originalText,")"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[t.isMasking&&t.maskingRiskLevel&&(0,s.jsxs)(eH,{variant:"outline",className:W("text-[10px] px-1.5",ae[t.maskingRiskLevel].color,"text-white border-0"),children:[(0,s.jsx)($.A,{className:"w-3 h-3 mr-0.5"}),"Masking"]}),r&&(0,s.jsx)(eH,{variant:"outline",className:"text-[10px]",children:t.sourceProvenance})]})]})}function at(e){let{ingredients:a,showProvenance:t=!1}=e,n=[...a].sort((e,a)=>{let t={unsafe:0,unknown:1,safe:2};return t[e.safetyStatus]-t[a.safetyStatus]});return(0,s.jsx)(e9,{children:(0,s.jsxs)("div",{"data-design-id":"ingredient-list",className:"space-y-2",children:[(0,s.jsxs)("div",{"data-design-id":"ingredient-list-header",className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["Ingredients (",a.length,")"]}),(0,s.jsxs)("div",{className:"flex gap-3 text-xs",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(e_.A,{className:"w-3.5 h-3.5 text-emerald-500"}),"Safe"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(eT.A,{className:"w-3.5 h-3.5 text-amber-500"}),"Unknown"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(eF.A,{className:"w-3.5 h-3.5 text-red-500"}),"Unsafe"]})]})]}),(0,s.jsx)("div",{className:"space-y-1.5",children:n.map((e,a)=>(0,s.jsx)(aa,{ingredient:e,index:a,showProvenance:t},a))})]})})}var as=t(6617),an=t(349),ai=t(7726),ar=t(9715),al=t(2529),ao=t(2894);let ad=(0,er.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ac=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(ao.b,{ref:a,className:W(ad(),t),...n})});ac.displayName=ao.b.displayName;let am=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("textarea",{className:W("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...n})});function au(e){let{initialUPC:a="",onSubmit:t,onCancel:r,isLoading:l=!1}=e,[o,d]=(0,n.useState)(a),[c,m]=(0,n.useState)(""),[u,f]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[g,p]=(0,n.useState)({}),y=async e=>{e.preventDefault();let a={},s=function(e){let a=e.replace(/[^0-9]/g,"");return 0===a.length?{valid:!1,message:"UPC is required"}:a.length<8?{valid:!1,message:"UPC must be at least 8 digits"}:a.length>14?{valid:!1,message:"UPC cannot exceed 14 digits"}:/^\d+$/.test(a)?{valid:!0}:{valid:!1,message:"UPC must contain only numbers"}}(o);if(s.valid||(a.upc=s.message||"Invalid UPC"),c.trim()||(a.name="Product name is required"),h.trim()?h.trim().length<10&&(a.ingredients="Please enter the complete ingredient list"):a.ingredients="Ingredients are required",Object.keys(a).length>0)return void p(a);p({}),await t({upc:o.replace(/[^0-9]/g,""),name:c.trim(),brand:u.trim()||void 0,ingredients:h.trim()})};return(0,s.jsxs)(i.P.form,{"data-design-id":"manual-entry-form",initial:{opacity:0,y:20},animate:{opacity:1,y:0},onSubmit:y,className:"space-y-6 p-1",children:[(0,s.jsxs)("div",{"data-design-id":"form-header",className:"text-center mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(as.A,{className:"w-8 h-8 text-primary"})}),(0,s.jsx)("h2",{"data-design-id":"form-title",className:"text-xl font-bold",children:"Add Product Manually"}),(0,s.jsx)("p",{"data-design-id":"form-subtitle",className:"text-muted-foreground text-sm mt-1",children:"Enter the product details from the label"})]}),(0,s.jsxs)("div",{"data-design-id":"form-field-upc",className:"space-y-2",children:[(0,s.jsxs)(ac,{htmlFor:"upc",className:"flex items-center gap-2",children:[(0,s.jsx)(an.A,{className:"w-4 h-4"}),"UPC / Barcode"]}),(0,s.jsx)(ey,{id:"upc",type:"text",inputMode:"numeric",placeholder:"Enter 8-14 digit barcode",value:o,onChange:e=>d(e.target.value.replace(/[^0-9]/g,"")),className:g.upc?"border-red-500":"",disabled:l}),g.upc&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:g.upc})]}),(0,s.jsxs)("div",{"data-design-id":"form-field-name",className:"space-y-2",children:[(0,s.jsxs)(ac,{htmlFor:"name",className:"flex items-center gap-2",children:[(0,s.jsx)(ai.A,{className:"w-4 h-4"}),"Product Name *"]}),(0,s.jsx)(ey,{id:"name",type:"text",placeholder:"e.g., Organic Whole Wheat Bread",value:c,onChange:e=>m(e.target.value),className:g.name?"border-red-500":"",disabled:l}),g.name&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:g.name})]}),(0,s.jsxs)("div",{"data-design-id":"form-field-brand",className:"space-y-2",children:[(0,s.jsxs)(ac,{htmlFor:"brand",className:"flex items-center gap-2",children:[(0,s.jsx)(as.A,{className:"w-4 h-4"}),"Brand (Optional)"]}),(0,s.jsx)(ey,{id:"brand",type:"text",placeholder:"e.g., Nature's Own",value:u,onChange:e=>f(e.target.value),disabled:l})]}),(0,s.jsxs)("div",{"data-design-id":"form-field-ingredients",className:"space-y-2",children:[(0,s.jsxs)(ac,{htmlFor:"ingredients",className:"flex items-center gap-2",children:[(0,s.jsx)(ar.A,{className:"w-4 h-4"}),"Ingredients *"]}),(0,s.jsx)(am,{id:"ingredients",placeholder:"Paste or type the ingredients list exactly as shown on the package. Separate ingredients with commas.",value:h,onChange:e=>x(e.target.value),className:"min-h-[150px] ".concat(g.ingredients?"border-red-500":""),disabled:l}),g.ingredients?(0,s.jsx)("p",{className:"text-xs text-red-500",children:g.ingredients}):(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:'Include all ingredients, sub-ingredients in parentheses, and any "contains" statements.'})]}),(0,s.jsxs)("div",{"data-design-id":"form-actions",className:"flex gap-3 pt-2",children:[r&&(0,s.jsx)(eo,{type:"button",variant:"outline",onClick:r,disabled:l,className:"flex-1",children:"Cancel"}),(0,s.jsx)(eo,{type:"submit",disabled:l,className:"flex-1",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eV.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Analyzing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(al.A,{className:"w-4 h-4 mr-2"}),"Add & Analyze"]})})]})]})}am.displayName="Textarea";let af=(0,er.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ah=n.forwardRef((e,a)=>{let{className:t,variant:n,...i}=e;return(0,s.jsx)("div",{ref:a,role:"alert",className:W(af({variant:n}),t),...i})});ah.displayName="Alert";let ax=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("h5",{ref:a,className:W("mb-1 font-medium leading-none tracking-tight",t),...n})});ax.displayName="AlertTitle";let ag=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:W("text-sm [&_p]:leading-relaxed",t),...n})});ag.displayName="AlertDescription";var ap=t(3409);let ay=ap.bL,ab=ap.l9,av=ap.ZL;ap.bm;let aj=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(ap.hJ,{ref:a,className:W("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});aj.displayName=ap.hJ.displayName;let aN=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,s.jsxs)(av,{children:[(0,s.jsx)(aj,{}),(0,s.jsxs)(ap.UC,{ref:a,className:W("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[n,(0,s.jsxs)(ap.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(eQ.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});aN.displayName=ap.UC.displayName;let aw=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:W("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};aw.displayName="DialogHeader";let ak=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:W("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};ak.displayName="DialogFooter";let aA=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(ap.hE,{ref:a,className:W("text-lg font-semibold leading-none tracking-tight",t),...n})});aA.displayName=ap.hE.displayName;let aC=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(ap.VY,{ref:a,className:W("text-sm text-muted-foreground",t),...n})});aC.displayName=ap.VY.displayName;var aS=t(8720),aP=t(5438),aR=t(5843);function az(){let[e,a]=(0,n.useState)("idle"),[t,l]=(0,n.useState)(!0),[o,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(null),[f,h]=(0,n.useState)(null),[x,g]=(0,n.useState)(""),[p,y]=(0,n.useState)(!1),{addToHistory:b,setActiveTab:v,setCurrentProduct:j,toggleFavorite:N}=m(),w=(0,n.useCallback)(async e=>{if(!p&&(e!==x||!t)){y(!0),g(e),a("loading"),l(!1);try{let t=await U(e);if(t.success&&t.product){var s,n;d(t.product),u(t.safety),h(t.risk||null),b(t.product),a("result"),(null==(s=t.safety)?void 0:s.overallStatus)==="safe"?aS.oR.success("Product is MTHFR Safe!"):(null==(n=t.safety)?void 0:n.overallStatus)==="unsafe"?aS.oR.warning("Found ".concat(t.safety.unsafeCount," unsafe ingredient(s)")):aS.oR.info("Some ingredients require review")}else if(t.notFound)a("not-found");else throw Error(t.error||"Failed to process product")}catch(e){console.error("Scan error:",e),aS.oR.error("Failed to look up product"),l(!0),a("idle")}finally{y(!1)}}},[p,x,b,t]),k=async e=>{y(!0);try{let t=await H(e.upc,e.name,e.ingredients,e.brand,void 0,"manual");if(t.success&&t.product)d(t.product),u(t.safety),h(t.risk||null),b(t.product),a("result"),aS.oR.success("Product added successfully!");else throw Error(t.error||"Failed to add product")}catch(e){console.error("Manual entry error:",e),aS.oR.error("Failed to add product")}finally{y(!1)}};return(0,s.jsxs)("div",{"data-design-id":"scan-screen",className:"h-full flex flex-col bg-background relative",children:[(0,s.jsx)(ay,{open:t,onOpenChange:l,children:(0,s.jsxs)(aN,{className:"p-0 border-none bg-black h-dvh w-screen max-w-none m-0 sm:rounded-none overflow-hidden [&>button]:hidden",children:[(0,s.jsx)(aA,{className:"sr-only",children:"Barcode Scanner"}),(0,s.jsx)(eX,{onScan:w,isActive:t,onClose:()=>l(!1)})]})}),(0,s.jsxs)(r.N,{mode:"wait",children:["idle"===e&&!t&&(0,s.jsxs)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex-1 flex flex-col items-center justify-center text-center p-6",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center mb-6",children:(0,s.jsx)(eY.A,{className:"w-10 h-10 text-primary"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Scanner Paused"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-8",children:"Tap below to reopen the camera and resume scanning products."}),(0,s.jsxs)(eo,{size:"lg",onClick:()=>l(!0),className:"gap-2",children:[(0,s.jsx)(eY.A,{className:"w-5 h-5"})," Open Scanner"]})]},"idle"),"loading"===e&&(0,s.jsxs)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex-1 flex flex-col items-center justify-center p-8",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-primary/10 flex items-center justify-center mb-6",children:(0,s.jsx)(eV.A,{className:"w-10 h-10 text-primary animate-spin"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Looking up product..."}),(0,s.jsx)("p",{className:"text-muted-foreground text-center",children:"Searching product databases and analyzing ingredients"}),(0,s.jsxs)("p",{className:"font-mono text-sm mt-4 text-muted-foreground",children:["UPC: ",x]})]},"loading"),"result"===e&&o&&(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex-1 flex flex-col h-full overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 flex items-center gap-3 border-b bg-background/80 backdrop-blur z-10 sticky top-0",children:[(0,s.jsx)(eo,{variant:"ghost",size:"icon",onClick:()=>l(!0),children:(0,s.jsx)(eJ.A,{className:"w-5 h-5"})}),(0,s.jsx)("h2",{className:"font-semibold flex-1 truncate",children:"Scan Result"}),(0,s.jsxs)(eo,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"gap-2",children:[(0,s.jsx)(eY.A,{className:"w-4 h-4"})," Scan Another"]})]}),(0,s.jsx)(eB,{className:"flex-1",children:(0,s.jsxs)("div",{className:"p-5 space-y-6 pb-24",children:[(0,s.jsx)(eG,{product:o,onToggleFavorite:()=>{o.id&&N(o.id)}}),(0,s.jsx)(at,{ingredients:o.ingredients,showProvenance:!0}),f&&(0,s.jsxs)("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-500",children:[(0,s.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,s.jsx)(ez.A,{className:"w-5 h-5 text-primary"}),"Risk Assessment"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-card border border-border space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(aP.A,{className:"w-4 h-4 text-primary"}),"GMO Detection"]}),(0,s.jsx)(eH,{variant:"low"===f.gmoStatus?"secondary":"high"===f.gmoStatus?"destructive":"outline",children:f.gmoStatus.toUpperCase()})]}),f.gmoReasoning&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:f.gmoReasoning})]}),(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-card border border-border space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(aR.A,{className:"w-4 h-4 text-primary"}),"Vendor Litigation"]}),(0,s.jsx)(eH,{variant:"none"===f.lawsuits.status?"secondary":"destructive",children:f.lawsuits.status.toUpperCase()})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:f.lawsuits.summary}),f.lawsuits.details.length>0&&(0,s.jsx)("ul",{className:"text-[10px] space-y-1 list-disc pl-4 text-muted-foreground",children:f.lawsuits.details.map((e,a)=>(0,s.jsx)("li",{children:e},a))})]}),(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-card border border-border space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(e0.A,{className:"w-4 h-4 text-primary"}),"Public Sentiment"]}),(0,s.jsx)(eH,{variant:"positive"===f.sentiment.label?"secondary":"negative"===f.sentiment.label?"destructive":"outline",children:f.sentiment.label.toUpperCase()})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:f.sentiment.anchors.map((e,a)=>(0,s.jsxs)(eH,{variant:"outline",className:"text-[10px] px-1.5 py-0 leading-tight",children:["#",e]},a))})]})]})]})]})})]},"result"),"not-found"===e&&(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex-1 flex flex-col h-full overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 flex items-center gap-3 border-b bg-background/80 backdrop-blur z-10 sticky top-0",children:[(0,s.jsx)(eo,{variant:"ghost",size:"icon",onClick:()=>l(!0),children:(0,s.jsx)(eJ.A,{className:"w-5 h-5"})}),(0,s.jsx)("h2",{className:"font-semibold flex-1",children:"Not Found"})]}),(0,s.jsx)(eB,{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-8 pb-24 min-h-[60vh]",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-amber-100 dark:bg-amber-950/50 flex items-center justify-center mb-6",children:(0,s.jsx)(eZ.A,{className:"w-12 h-12 text-amber-600 dark:text-amber-400"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Product Not in Database"}),(0,s.jsx)("p",{className:"text-muted-foreground text-center mb-2",children:"We couldn't find this product in our databases."}),(0,s.jsxs)("p",{className:"font-mono text-sm text-muted-foreground mb-6",children:["UPC: ",x]}),(0,s.jsxs)(ah,{className:"mb-6 max-w-sm",children:[(0,s.jsx)(e$.A,{className:"w-4 h-4"}),(0,s.jsx)(ax,{children:"Help improve the database"}),(0,s.jsx)(ag,{children:"You can add this product manually by entering its name and ingredient list."})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 w-full max-w-sm",children:[(0,s.jsx)(eo,{variant:"secondary",onClick:()=>window.open("https://www.google.com/search?q=UPC+".concat(x),"_blank"),className:"w-full",children:"Search Web for UPC"}),(0,s.jsxs)("div",{className:"flex gap-3 w-full",children:[(0,s.jsx)(eo,{variant:"outline",onClick:()=>l(!0),className:"flex-1",children:"Scan Again"}),(0,s.jsx)(eo,{onClick:()=>a("manual-entry"),className:"flex-1",children:"Add Manually"})]})]})]})})]},"not-found"),"manual-entry"===e&&(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex-1 flex flex-col h-full overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 flex items-center gap-3 border-b bg-background/80 backdrop-blur z-10 sticky top-0",children:[(0,s.jsx)(eo,{variant:"ghost",size:"icon",onClick:()=>a("not-found"),children:(0,s.jsx)(eJ.A,{className:"w-5 h-5"})}),(0,s.jsx)("h2",{className:"font-semibold",children:"Manual Entry"})]}),(0,s.jsx)(eB,{className:"flex-1",children:(0,s.jsx)("div",{className:"p-5 pb-24",children:(0,s.jsx)(au,{initialUPC:x,onSubmit:k,onCancel:()=>a("not-found"),isLoading:p})})})]},"manual-entry")]})]})}var aM=t(6955),a_=t(5978),aT=t(5667);let aF=aT.bL,aL=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(aT.B8,{ref:a,className:W("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...n})});aL.displayName=aT.B8.displayName;let aD=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(aT.l9,{ref:a,className:W("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...n})});aD.displayName=aT.l9.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(aT.UC,{ref:a,className:W("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n})}).displayName=aT.UC.displayName;var aU=t(7738),aH=t(5917),aI=t(9051);let aE=aU.bL,aG=aU.l9;aU.YJ,aU.ZL,aU.Pb,aU.z6,n.forwardRef((e,a)=>{let{className:t,inset:n,children:i,...r}=e;return(0,s.jsxs)(aU.ZP,{ref:a,className:W("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...r,children:[i,(0,s.jsx)(en.A,{className:"ml-auto"})]})}).displayName=aU.ZP.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(aU.G5,{ref:a,className:W("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}).displayName=aU.G5.displayName;let aO=n.forwardRef((e,a)=>{let{className:t,sideOffset:n=4,...i}=e;return(0,s.jsx)(aU.ZL,{children:(0,s.jsx)(aU.UC,{ref:a,sideOffset:n,className:W("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...i})})});aO.displayName=aU.UC.displayName;let aB=n.forwardRef((e,a)=>{let{className:t,inset:n,...i}=e;return(0,s.jsx)(aU.q7,{ref:a,className:W("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",n&&"pl-8",t),...i})});function aq(){let{scanHistory:e,favorites:a,currentProduct:t,setCurrentProduct:l,toggleFavorite:o,clearHistory:d}=m(),[c,u]=(0,n.useState)(""),[f,h]=(0,n.useState)("recent"),[x,g]=(0,n.useState)("all"),[p,y]=(0,n.useState)("all"),b=e=>T(e.ingredients).overallStatus,v=(e=>{let a=[...e];if(c){let e=c.toLowerCase();a=a.filter(a=>{var t;return a.name.toLowerCase().includes(e)||(null==(t=a.brand)?void 0:t.toLowerCase().includes(e))||a.upc.includes(e)})}return"all"!==x&&(a=a.filter(e=>b(e)===x)),a.sort((e,a)=>{switch(f){case"name":return e.name.localeCompare(a.name);case"safety":{let t={unsafe:0,unknown:1,safe:2};return t[b(e)]-t[b(a)]}default:return new Date(a.lastScannedAt||a.createdAt).getTime()-new Date(e.lastScannedAt||e.createdAt).getTime()}}),a})("favorites"===p?a:e);return t?(T(t.ingredients),(0,s.jsxs)("div",{"data-design-id":"product-detail",className:"h-full flex flex-col bg-background",children:[(0,s.jsxs)("div",{"data-design-id":"detail-header",className:"p-4 flex items-center gap-3 border-b",children:[(0,s.jsx)(eo,{"data-design-id":"detail-back",variant:"ghost",size:"icon",onClick:()=>l(null),children:(0,s.jsx)(eJ.A,{className:"w-5 h-5"})}),(0,s.jsx)("h2",{className:"font-semibold flex-1 truncate",children:t.name}),(0,s.jsx)(eo,{"data-design-id":"detail-favorite",variant:"ghost",size:"icon",onClick:()=>t.id&&o(t.id),children:(0,s.jsx)(eg.A,{className:"w-5 h-5 ".concat(t.isFavorite?"fill-red-500 text-red-500":"")})})]}),(0,s.jsx)(eB,{className:"flex-1",children:(0,s.jsxs)("div",{className:"p-5 space-y-6 pb-24",children:[(0,s.jsx)(eG,{product:t}),(0,s.jsx)(at,{ingredients:t.ingredients,showProvenance:!0}),(0,s.jsxs)("div",{"data-design-id":"product-meta",className:"text-xs text-muted-foreground space-y-1",children:[(0,s.jsxs)("p",{children:["UPC: ",t.upc]}),(0,s.jsxs)("p",{children:["Source: ",t.sourceProvenance]}),(0,s.jsxs)("p",{children:["Added: ",new Date(t.createdAt).toLocaleDateString()]}),t.lastScannedAt&&(0,s.jsxs)("p",{children:["Last scanned:"," ",new Date(t.lastScannedAt).toLocaleDateString()]})]})]})})]})):(0,s.jsxs)("div",{"data-design-id":"history-screen",className:"h-full flex flex-col bg-background",children:[(0,s.jsxs)("div",{"data-design-id":"history-header",className:"p-4 border-b space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{"data-design-id":"history-title",className:"text-xl font-bold",children:"Product History"}),(0,s.jsxs)(eH,{"data-design-id":"history-count",variant:"secondary",children:[e.length," products"]})]}),(0,s.jsx)(aF,{value:p,onValueChange:e=>y(e),children:(0,s.jsxs)(aL,{"data-design-id":"history-tabs",className:"w-full",children:[(0,s.jsxs)(aD,{"data-design-id":"tab-all",value:"all",className:"flex-1",children:[(0,s.jsx)(G.A,{className:"w-4 h-4 mr-2"}),"All Scans"]}),(0,s.jsxs)(aD,{"data-design-id":"tab-favorites",value:"favorites",className:"flex-1",children:[(0,s.jsx)(eg.A,{className:"w-4 h-4 mr-2"}),"Favorites (",a.length,")"]})]})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(ef.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(ey,{"data-design-id":"history-search",placeholder:"Search products...",value:c,onChange:e=>u(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(aE,{children:[(0,s.jsx)(aG,{asChild:!0,children:(0,s.jsx)(eo,{"data-design-id":"filter-btn",variant:"outline",size:"icon",children:(0,s.jsx)(aM.A,{className:"w-4 h-4"})})}),(0,s.jsxs)(aO,{align:"end",children:[(0,s.jsxs)(aB,{onClick:()=>g("all"),children:["All Products","all"===x&&(0,s.jsx)("span",{className:"ml-auto",children:""})]}),(0,s.jsxs)(aB,{onClick:()=>g("safe"),children:["Safe Only","safe"===x&&(0,s.jsx)("span",{className:"ml-auto",children:""})]}),(0,s.jsxs)(aB,{onClick:()=>g("unsafe"),children:["Unsafe Only","unsafe"===x&&(0,s.jsx)("span",{className:"ml-auto",children:""})]}),(0,s.jsxs)(aB,{onClick:()=>g("unknown"),children:["Unknown Only","unknown"===x&&(0,s.jsx)("span",{className:"ml-auto",children:""})]})]})]}),(0,s.jsxs)(aE,{children:[(0,s.jsx)(aG,{asChild:!0,children:(0,s.jsx)(eo,{"data-design-id":"sort-btn",variant:"outline",size:"icon",children:(0,s.jsx)(a_.A,{className:"w-4 h-4"})})}),(0,s.jsxs)(aO,{align:"end",children:[(0,s.jsxs)(aB,{onClick:()=>h("recent"),children:["Most Recent","recent"===f&&(0,s.jsx)("span",{className:"ml-auto",children:""})]}),(0,s.jsxs)(aB,{onClick:()=>h("name"),children:["Name (A-Z)","name"===f&&(0,s.jsx)("span",{className:"ml-auto",children:""})]}),(0,s.jsxs)(aB,{onClick:()=>h("safety"),children:["Safety Status","safety"===f&&(0,s.jsx)("span",{className:"ml-auto",children:""})]})]})]})]})]}),(0,s.jsx)(eB,{className:"flex-1",children:(0,s.jsx)("div",{className:"p-4 pb-24 space-y-2",children:(0,s.jsx)(r.N,{mode:"popLayout",children:v.length>0?v.map((e,a)=>(0,s.jsx)(i.P.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:.05*a},children:(0,s.jsx)(eG,{product:e,compact:!0,onSelect:()=>l(e)})},e.id)):(0,s.jsxs)(i.P.div,{"data-design-id":"history-empty",initial:{opacity:0},animate:{opacity:1},className:"text-center py-16",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-muted flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(as.A,{className:"w-10 h-10 text-muted-foreground"})}),(0,s.jsx)("h3",{"data-design-id":"empty-title",className:"font-semibold mb-2",children:c?"No matching products":"favorites"===p?"No favorites yet":"No products scanned"}),(0,s.jsx)("p",{"data-design-id":"empty-desc",className:"text-sm text-muted-foreground",children:c?"Try adjusting your search or filters":"favorites"===p?"Tap the heart icon on a product to add it to favorites":"Start scanning products to build your history"})]})})})})]})}aB.displayName=aU.q7.displayName,n.forwardRef((e,a)=>{let{className:t,children:n,checked:i,...r}=e;return(0,s.jsxs)(aU.H_,{ref:a,className:W("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:i,...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(aU.VF,{children:(0,s.jsx)(aH.A,{className:"h-4 w-4"})})}),n]})}).displayName=aU.H_.displayName,n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,s.jsxs)(aU.hN,{ref:a,className:W("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(aU.VF,{children:(0,s.jsx)(aI.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=aU.hN.displayName,n.forwardRef((e,a)=>{let{className:t,inset:n,...i}=e;return(0,s.jsx)(aU.JU,{ref:a,className:W("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...i})}).displayName=aU.JU.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(aU.wv,{ref:a,className:W("-mx-1 my-1 h-px bg-muted",t),...n})}).displayName=aU.wv.displayName;var aW=t(6154),aY=t(1503),aV=t(7526),aJ=t(968),aZ=t(9e3),a$=t(552),aK=t(3153),aQ=t(2944),aX=t(7494),a0=t(9427),a1=t(9867),a5=t(1360),a2=t(1873),a4=t(7586),a3=t(1169);let a6=[{type:"location",title:"Location Access",description:"Help find local product availability and regional formulations",howUsed:"Location is used to find nearby stores carrying products and identify region-specific product variations that may have different ingredients.",icon:a2.A,iconColor:"text-blue-500"},{type:"photo",title:"Photo Upload & Analysis",description:"Scan ingredient labels using your camera for OCR analysis",howUsed:"Photos of product labels are processed using OCR to extract ingredient lists. This helps verify or supplement data from product databases.",icon:eC.A,iconColor:"text-purple-500"},{type:"review",title:"Review Aggregation",description:"Access community reviews for additional ingredient insights",howUsed:"With your permission, we search public product reviews for mentions of ingredients that may not appear on standard labels.",icon:a4.A,iconColor:"text-amber-500"},{type:"data_contribution",title:"Data Contribution",description:"Share your findings to improve the database for everyone",howUsed:"Your manually entered products and OCR corrections help improve ingredient data accuracy for the entire community.",icon:a3.A,iconColor:"text-emerald-500"}];function a8(e){let{config:a,isGranted:t,onToggle:n}=e,r=a.icon;return(0,s.jsx)(i.P.div,{"data-design-id":"consent-item-".concat(a.type),initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:W("p-4 rounded-xl border transition-colors",t?"bg-primary/5 border-primary/20":"bg-card border-border"),children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:W("w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",t?"bg-primary/10":"bg-muted"),children:(0,s.jsx)(r,{className:W("w-5 h-5",t?a.iconColor:"text-muted-foreground")})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsx)("h4",{"data-design-id":"consent-title-".concat(a.type),className:"font-semibold",children:a.title}),(0,s.jsx)(ec,{"data-design-id":"consent-toggle-".concat(a.type),checked:t,onCheckedChange:n})]}),(0,s.jsx)("p",{"data-design-id":"consent-desc-".concat(a.type),className:"text-sm text-muted-foreground mt-1",children:a.description}),t&&(0,s.jsx)(i.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 p-3 bg-background rounded-lg border border-border/50",children:(0,s.jsxs)("div",{className:"flex items-start gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(e0.A,{className:"w-3.5 h-3.5 mt-0.5 flex-shrink-0"}),(0,s.jsx)("p",{children:a.howUsed})]})})]})]})})}function a9(){let{consents:e,setConsent:a}=m();return(0,s.jsxs)("div",{"data-design-id":"consent-manager",className:"space-y-6",children:[(0,s.jsxs)(eb,{"data-design-id":"consent-header-card",children:[(0,s.jsx)(ev,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(Z.A,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(ej,{"data-design-id":"consent-manager-title",children:"Privacy & Permissions"}),(0,s.jsx)(eN,{"data-design-id":"consent-manager-desc",children:"Control how your data is collected and used"})]})]})}),(0,s.jsx)(ew,{children:(0,s.jsxs)(ah,{"data-design-id":"consent-info-alert",children:[(0,s.jsx)(e0.A,{className:"w-4 h-4"}),(0,s.jsx)(ag,{children:"All data collection is opt-in. The app works fully offline with core features. Enable permissions only for features you want to use."})]})})]}),(0,s.jsx)("div",{"data-design-id":"consent-list",className:"space-y-3",children:a6.map((t,n)=>{var r;return(0,s.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*n},children:(0,s.jsx)(a8,{config:t,isGranted:(null==(r=e[t.type])?void 0:r.granted)||!1,onToggle:e=>a(t.type,e)})},t.type)})}),(0,s.jsx)(eb,{"data-design-id":"data-policy-card",className:"bg-muted/30",children:(0,s.jsxs)(ew,{className:"pt-4",children:[(0,s.jsx)("h4",{"data-design-id":"data-policy-title",className:"font-semibold text-sm mb-2",children:"How We Protect Your Data"}),(0,s.jsxs)("ul",{className:"space-y-2 text-xs text-muted-foreground",children:[(0,s.jsxs)("li",{"data-design-id":"data-policy-item-1",className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary",children:""}),"All product data is stored locally on your device using IndexedDB"]}),(0,s.jsxs)("li",{"data-design-id":"data-policy-item-2",className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary",children:""}),"Photos are processed on-device when possible; never stored on servers"]}),(0,s.jsxs)("li",{"data-design-id":"data-policy-item-3",className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary",children:""}),"Location data is used only for queries and never logged"]}),(0,s.jsxs)("li",{"data-design-id":"data-policy-item-4",className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary",children:""}),"You can withdraw consent and delete all data at any time"]})]})]})})]})}var a7=t(7321);let te=n.forwardRef((e,a)=>{let{className:t,orientation:n="horizontal",decorative:i=!0,...r}=e;return(0,s.jsx)(a7.b,{ref:a,decorative:i,orientation:n,className:W("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",t),...r})});function ta(){let{clearHistory:e,scanHistory:a,restrictionSettings:t,toggleRestriction:r,toggleAllRestrictions:l}=m(),[o,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),f=["allergy_soy","allergy_wheat","allergy_milk","allergy_egg","allergy_peanut","allergy_treenuts","allergy_fish","allergy_shellfish","allergy_sesame"],h=["mutation_g6pd"],x=async()=>{try{let e=await v(),a=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download="mthfr-scanner-export-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),aS.oR.success("Data exported successfully!")}catch(e){aS.oR.error("Failed to export data")}},g=async()=>{try{await b(),e(),u(!1),aS.oR.success("All data cleared")}catch(e){aS.oR.error("Failed to clear data")}};return(0,s.jsx)(eB,{className:"h-full",children:(0,s.jsxs)("div",{"data-design-id":"settings-screen",className:"pb-24 px-5 pt-4 space-y-6",children:[(0,s.jsxs)(i.P.div,{"data-design-id":"settings-header",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[(0,s.jsxs)("h1",{"data-design-id":"settings-title",className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(O.A,{className:"w-6 h-6"}),"Settings"]}),(0,s.jsx)("p",{"data-design-id":"settings-subtitle",className:"text-muted-foreground",children:"Manage your preferences and data"})]}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,s.jsx)(a9,{})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},children:(0,s.jsxs)(eb,{"data-design-id":"health-standards-card",children:[(0,s.jsxs)(ev,{className:"pb-3",children:[(0,s.jsxs)(ej,{className:"text-base flex items-center gap-2",children:[(0,s.jsx)(ee.A,{className:"w-4 h-4"}),"Health Standards & Restrictions"]}),(0,s.jsx)(eN,{children:"Customize which health standards to apply during scans"})]}),(0,s.jsxs)(ew,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/30",children:(0,s.jsx)(Q.A,{className:"w-4 h-4 text-emerald-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:"MTHFR Support"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Avoid synthetic folic acid & B12"})]})]}),(0,s.jsx)(ec,{checked:t.mthfr,onCheckedChange:()=>r("mthfr")})]}),(0,s.jsx)(te,{}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:(0,s.jsx)(X.A,{className:"w-4 h-4 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:"EU Standards"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Avoid ingredients banned in the EU"})]})]}),(0,s.jsx)(ec,{checked:t.eu_standards,onCheckedChange:()=>r("eu_standards")})]}),(0,s.jsx)(te,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30",children:(0,s.jsx)(ee.A,{className:"w-5 h-5 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"font-semibold text-sm",children:"Genetic Mutations"}),(0,s.jsx)(eH,{variant:"secondary",className:"h-5 px-1.5 text-[10px]",children:h.filter(e=>t[e]).length})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Avoid triggers for specific variants"})]})]}),(0,s.jsx)(ec,{checked:h.every(e=>t[e]),onCheckedChange:e=>l(h,e)})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2 pl-11",children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-transparent hover:border-border transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(aW.A,{className:"w-3.5 h-3.5 text-amber-500"}),(0,s.jsx)("p",{className:"text-xs font-medium",children:"G6PD (Favism)"})]}),(0,s.jsx)(ec,{size:"sm",checked:t.mutation_g6pd,onCheckedChange:()=>r("mutation_g6pd")})]})})]}),(0,s.jsx)(te,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-900/30",children:(0,s.jsx)(ea.A,{className:"w-5 h-5 text-orange-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"font-semibold text-sm",children:"Common Allergens"}),(0,s.jsx)(eH,{variant:"secondary",className:"h-5 px-1.5 text-[10px]",children:f.filter(e=>t[e]).length})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Safety checks for prevalent allergies"})]})]}),(0,s.jsx)(ec,{checked:f.every(e=>t[e]),onCheckedChange:e=>l(f,e)})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 pl-11 pb-2",children:[{id:"allergy_soy",label:"Soy",icon:aY.A,color:"text-emerald-500"},{id:"allergy_wheat",label:"Wheat",icon:aV.A,color:"text-amber-600"},{id:"allergy_milk",label:"Milk",icon:aJ.A,color:"text-blue-400"},{id:"allergy_egg",label:"Egg",icon:aZ.A,color:"text-orange-400"},{id:"allergy_peanut",label:"Peanut",icon:a$.A,color:"text-amber-800"},{id:"allergy_treenuts",label:"Tree Nuts",icon:a$.A,color:"text-stone-600"},{id:"allergy_fish",label:"Fish",icon:aK.A,color:"text-cyan-500"},{id:"allergy_shellfish",label:"Shellfish",icon:aQ.A,color:"text-rose-400"},{id:"allergy_sesame",label:"Sesame",icon:aJ.A,color:"text-yellow-600"}].map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-transparent hover:border-border transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,s.jsx)(e.icon,{className:W("w-3.5 h-3.5 flex-shrink-0",e.color)}),(0,s.jsx)("p",{className:"text-[11px] font-medium truncate",children:e.label})]}),(0,s.jsx)(ec,{size:"sm",checked:t[e.id],onCheckedChange:()=>r(e.id)})]},e.id))})]})]})]})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,s.jsxs)(eb,{"data-design-id":"appearance-card",children:[(0,s.jsx)(ev,{className:"pb-3",children:(0,s.jsxs)(ej,{"data-design-id":"appearance-title",className:"text-base flex items-center gap-2",children:[o?(0,s.jsx)(aX.A,{className:"w-4 h-4"}):(0,s.jsx)(a0.A,{className:"w-4 h-4"}),"Appearance"]})}),(0,s.jsx)(ew,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{"data-design-id":"dark-mode-label",className:"font-medium",children:"Dark Mode"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Use dark theme for reduced eye strain"})]}),(0,s.jsx)(ec,{"data-design-id":"dark-mode-toggle",checked:o,onCheckedChange:()=>{d(!o),document.documentElement.classList.toggle("dark")}})]})})]})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,s.jsxs)(eb,{"data-design-id":"data-card",children:[(0,s.jsxs)(ev,{className:"pb-3",children:[(0,s.jsxs)(ej,{"data-design-id":"data-title",className:"text-base flex items-center gap-2",children:[(0,s.jsx)(eA.A,{className:"w-4 h-4"}),"Data Management"]}),(0,s.jsxs)(eN,{children:[a.length," products in history"]})]}),(0,s.jsxs)(ew,{className:"space-y-3",children:[(0,s.jsxs)(eo,{"data-design-id":"export-btn",variant:"outline",className:"w-full justify-between",onClick:x,children:[(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(a1.A,{className:"w-4 h-4"}),"Export Data"]}),(0,s.jsx)(en.A,{className:"w-4 h-4 text-muted-foreground"})]}),(0,s.jsxs)(ay,{open:c,onOpenChange:u,children:[(0,s.jsx)(ab,{asChild:!0,children:(0,s.jsxs)(eo,{"data-design-id":"clear-btn",variant:"outline",className:"w-full justify-between text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30",children:[(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(a5.A,{className:"w-4 h-4"}),"Clear All Data"]}),(0,s.jsx)(en.A,{className:"w-4 h-4"})]})}),(0,s.jsxs)(aN,{children:[(0,s.jsxs)(aw,{children:[(0,s.jsx)(aA,{children:"Clear All Data?"}),(0,s.jsx)(aC,{children:"This will permanently delete all your scanned products, history, and favorites. This action cannot be undone."})]}),(0,s.jsxs)(ak,{className:"gap-2 sm:gap-0",children:[(0,s.jsx)(eo,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),(0,s.jsx)(eo,{variant:"destructive",onClick:g,children:"Yes, Clear All"})]})]})]})]})]})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,s.jsxs)(eb,{"data-design-id":"about-card",children:[(0,s.jsx)(ev,{className:"pb-3",children:(0,s.jsxs)(ej,{"data-design-id":"about-title",className:"text-base flex items-center gap-2",children:[(0,s.jsx)(eT.A,{className:"w-4 h-4"}),"About MTHFR & This App"]})}),(0,s.jsx)(ew,{children:(0,s.jsxs)(e2,{type:"single",collapsible:!0,className:"w-full",children:[(0,s.jsxs)(e4,{value:"what-is-mthfr",children:[(0,s.jsx)(e3,{"data-design-id":"faq-mthfr",children:"What is MTHFR?"}),(0,s.jsx)(e6,{children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"MTHFR (methylenetetrahydrofolate reductase) is an enzyme that plays a crucial role in processing folate and supporting methylationa vital biochemical process affecting DNA repair, detoxification, and neurotransmitter production. Genetic variants (like C677T and A1298C) can reduce enzyme efficiency by 30-70%, making it important to avoid synthetic folic acid and other problematic ingredients."})})]}),(0,s.jsxs)(e4,{value:"classification",children:[(0,s.jsx)(e3,{"data-design-id":"faq-classification",children:"How are ingredients classified?"}),(0,s.jsx)(e6,{children:(0,s.jsxs)("div",{className:"text-sm text-muted-foreground space-y-3",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{className:"text-foreground",children:"Safe (Green):"})," ","Ingredients that support methylation or have no negative impact. Includes methylated vitamins, whole foods, and natural ingredients."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{className:"text-foreground",children:"Unsafe (Red):"})," ","Ingredients that may interfere with methylation. Includes synthetic folic acid, cyanocobalamin, MSG, and certain preservatives."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{className:"text-foreground",children:"Unknown (Yellow):"})," ","Ingredients without enough research to classify, or ingredients that may affect individuals differently."]})]})})]}),(0,s.jsxs)(e4,{value:"masking",children:[(0,s.jsx)(e3,{"data-design-id":"faq-masking",children:"What are masking ingredients?"}),(0,s.jsx)(e6,{children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:'Masking ingredients are vague terms like "natural flavors," "spices," or "proprietary blend" that can hide undisclosed components. These may contain MSG, synthetic additives, or other problematic ingredients. We flag these for your awareness so you can investigate further or contact the manufacturer for clarification.'})})]}),(0,s.jsxs)(e4,{value:"accuracy",children:[(0,s.jsx)(e3,{"data-design-id":"faq-accuracy",children:"How accurate is this app?"}),(0,s.jsx)(e6,{children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"This app is a tool for awareness, not medical advice. While we strive for accuracy using product databases and research-backed classifications, ingredient lists can change, regional variations exist, and individual sensitivities vary. Always consult healthcare providers for personalized guidance, especially regarding MTHFR-related dietary changes."})})]})]})})]})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,s.jsx)(eb,{"data-design-id":"app-info-card",className:"bg-muted/30",children:(0,s.jsxs)(ew,{className:"pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(Z.A,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{"data-design-id":"app-name",className:"font-semibold",children:"MTHFR Food Scanner"}),(0,s.jsx)("p",{"data-design-id":"app-version",className:"text-sm text-muted-foreground",children:"Version 1.0.0"})]})]}),(0,s.jsx)("p",{"data-design-id":"app-description",className:"text-xs text-muted-foreground",children:"A local-first PWA for MTHFR-conscious individuals to evaluate food product safety. All data is stored locally on your device. No account required."})]})})})]})})}function tt(){let{activeTab:e,hasCompletedOnboarding:a}=m(),[t,l]=(0,n.useState)(!0);if((0,n.useEffect)(()=>{(async()=>{try{await D()}catch(e){console.error("Failed to initialize services:",e)}finally{l(!1)}})()},[]),t)return(0,s.jsx)("div",{"data-design-id":"loading-screen",className:"fixed inset-0 flex flex-col items-center justify-center bg-slate-50 dark:bg-slate-950",children:(0,s.jsxs)(i.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"flex flex-col items-center",children:[(0,s.jsx)("div",{"data-design-id":"loading-icon",className:"w-24 h-24 rounded-3xl bg-gradient-to-br from-primary to-emerald-600 flex items-center justify-center mb-8 shadow-2xl shadow-primary/30",children:(0,s.jsx)(Z.A,{className:"w-12 h-12 text-white"})}),(0,s.jsx)("h1",{"data-design-id":"loading-title",className:"text-2xl font-bold mb-3 tracking-tight",children:"MTHFR Scanner"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground font-medium",children:[(0,s.jsx)(eV.A,{className:"w-5 h-5 animate-spin text-primary"}),(0,s.jsx)("span",{"data-design-id":"loading-text",children:"Optimizing Engines..."})]})]})});if(!a)return(0,s.jsx)(eu,{});let o={initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20}};return(0,s.jsxs)("div",{"data-design-id":"desktop-frame",className:"fixed inset-0 flex flex-col items-center justify-center bg-slate-50 dark:bg-zinc-950 w-full overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 z-0 bg-grid-slate-200/50 dark:bg-grid-white/[0.02] bg-[size:32px_32px]"}),(0,s.jsxs)("div",{"data-design-id":"app-shell",className:"relative z-10 flex flex-col bg-background w-full h-[100dvh] pb-[env(safe-area-inset-bottom)] sm:h-[100dvh] sm:max-h-[850px] sm:w-[400px] sm:shadow-[0_0_40px_-10px_rgba(0,0,0,0.2)] sm:border sm:border-border sm:rounded-[2.5rem] overflow-hidden sm:my-8",children:[(0,s.jsx)("main",{"data-design-id":"main-content",className:"flex-1 overflow-hidden relative",children:(0,s.jsxs)(r.N,{mode:"wait",children:["home"===e&&(0,s.jsx)(i.P.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.2},className:"h-full",children:(0,s.jsx)(eW,{})},"home"),"scan"===e&&(0,s.jsx)(i.P.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.2},className:"h-full",children:(0,s.jsx)(az,{})},"scan"),"history"===e&&(0,s.jsx)(i.P.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.2},className:"h-full",children:(0,s.jsx)(aq,{})},"history"),"settings"===e&&(0,s.jsx)(i.P.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.2},className:"h-full",children:(0,s.jsx)(ta,{})},"settings")]})}),(0,s.jsx)(V,{})]})]})}function ts(){return(0,s.jsx)(tt,{})}te.displayName=a7.b.displayName},4574:(e,a,t)=>{Promise.resolve().then(t.bind(t,294))}},e=>{e.O(0,[604,720,758,441,255,358],()=>e(e.s=4574)),_N_E=e.O()}]);